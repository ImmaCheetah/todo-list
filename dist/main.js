(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{kj:()=>v,F5:()=>h,k3:()=>E,HA:()=>g});const t={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let n;const o=new Uint8Array(16);function d(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}const l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));const r=function(e,n,o){if(t.randomUUID&&!n&&!e)return t.randomUUID();const r=(e=e||{}).random||(e.rng||d)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,n){o=o||0;for(let e=0;e<16;++e)n[o+e]=r[e];return n}return function(e,t=0){return l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]}(r)};function a(e,t,n,o){let d=r(),l=!1;e=e.toString(),t=t.toString();const a=e=>{o=e};return{get title(){return e},get description(){return t},get dueDate(){return n},get priority(){return o},getCompleteState:()=>l,setComplete:()=>{l=!0},changePriority:a,editTask:(o,d,l,r)=>{e=o,t=d,n=l,a(r)},printTask:()=>{console.log(`Task title - ${e}, Desc - ${t}, Date - ${n}, Priority - ${o}`)},myTaskUuid:d}}function i(e){let t=r(),n=[];return{title:e,tasks:n,myFolderUuid:t,addTask:e=>{n.push(e)},displayTasks:()=>{for(let e=0;e<n.length;e++)console.log(`Task ${e} - ${n[e].title}, ${n[e].dueDate}, ${n[e].priority}`)},deleteTask:e=>{for(let t=n.length-1;t>=0;--t)n[t].myTaskUuid===e.myTaskUuid&&n.splice(t,1)}}}function s(e){e.tasks.forEach((e=>{!function(e,t){let n=function(e){const t=document.createElement("div"),n=document.createElement("p"),o=document.createElement("p"),d=document.createElement("p"),l=document.createElement("p");return t.classList.add("task-div"),n.textContent=e.title,o.textContent=e.description,d.textContent=e.dueDate,l.textContent=e.priority,t.appendChild(n),t.appendChild(o),t.appendChild(d),t.appendChild(l),(function(e){const t=document.createElement("button");return t.classList.add("task-delete-btn"),t.textContent="-",e.appendChild(t),t.addEventListener("click",(function(e){let t=e.target;E(t.value),t.parentNode.remove()})),t}(t)).value=e.myTaskUuid,(function(e){const t=document.createElement("button");return t.classList.add("task-edit-btn"),t.textContent="+",e.appendChild(t),t.addEventListener("click",(function(){})),t}(t)).value=e.myTaskUuid,(function(e){const t=document.createElement("button");return t.classList.add("task-status-btn"),t.textContent="âœ”",e.appendChild(t),t.addEventListener("click",(function(e){v(e.target.value)})),t}(t)).value=e.myTaskUuid,t}(e);document.getElementById(["task-container"]).appendChild(n)}(e)}))}function c(e){let t=function(e){const t=document.querySelector(".sidebar"),n=document.createElement("div"),o=document.createElement("button");return n.classList.add("folder-div"),o.classList.add("folder-button"),o.textContent=e.title,o.value=e.myFolderUuid,n.appendChild(o),(function(e){const t=document.createElement("button");return t.classList.add("folder-delete-btn"),t.textContent="-",e.appendChild(t),t.addEventListener("click",(function(e){let t=e.target;h(t.value),t.parentNode.remove()})),t}(n)).value=e.myFolderUuid,t.appendChild(n),o.addEventListener("click",(function(){let t=e.myFolderUuid;return g(e.myFolderUuid),console.log(e.title,e.myFolderUuid),t})),n}(e);document.querySelector(".sidebar").appendChild(t)}const u=function(){let e=[];return{folders:e,addFolder:t=>{e.push(t)},deleteFolder:t=>{for(let n=e.length-1;n>=0;--n)e[n].myFolderUuid===t.myFolderUuid&&e.splice(n,1)}}}(),m=i("Inbox"),f=a("chores","wash dishes","nov 23","high"),p=a("movies","avatar","nov 29","med"),k=a("coding","todo list","dec 10","low");function y(){return document.getElementById("task-dialog")}function g(e){u.folders.forEach((t=>{e===t.myFolderUuid&&(document.getElementById("task-container").textContent="",s(t),console.log("match found"))}))}function h(e){u.folders.forEach((t=>{e===t.myFolderUuid&&(console.log(e),u.deleteFolder(t))}))}function E(e){u.folders.forEach((t=>{t.tasks.forEach((n=>{e===n.myTaskUuid&&t.deleteTask(n)}))}))}function v(e){u.folders.forEach((t=>{t.tasks.forEach((t=>{e===t.myTaskUuid&&t.setComplete()}))})),console.log(f.getCompleteState())}f.editTask("new thing","another new thing","new date","HIGH"),m.addTask(k),m.addTask(p),m.addTask(f),m.displayTasks(),u.addFolder(m),console.log(u),document.getElementById("open-task-modal-btn").addEventListener("click",(function(){y().showModal(),function(e){const t=document.getElementById("folder-selection");!function(e){for(let t=e.options.length;t>=0;t--)e.remove(0)}(t),e.folders.forEach((e=>{const n=document.createElement("option");n.textContent=e.title,n.value=e.myFolderUuid,t.appendChild(n)}))}(u)})),document.getElementById("folder-add-btn").addEventListener("click",(function(){document.getElementById("folder-dialog").showModal()})),document.getElementById("folder-confirm-btn").addEventListener("click",(function(e){e.preventDefault();const t=document.getElementById("folder-dialog"),{folderTitleInForm:n}=function(){const e=document.getElementById("folder-form");return{folderForm:e,folderTitleInForm:e.elements["folder-title"].value}}();let o=i(n);c(o),u.addFolder(o),console.log(u.folders),t.close()})),document.getElementById("task-add-btn").addEventListener("click",(function(e){e.preventDefault();const t=document.getElementById("folder-selection").value,{taskTitle:n,taskDescription:o,taskDueDate:d,taskPriority:l}=function(){const e=document.getElementById("main-form"),t=e.elements["task-title"],n=e.elements["task-description"],o=e.elements["task-due-date"],d=e.elements["task-priority"];return{taskTitle:t.value,taskDescription:n.value,taskDueDate:o.value,taskPriority:d.value}}(),r=a(n,o,d,l);u.folders.forEach((e=>{t===e.myFolderUuid&&e.addTask(r)})),g(t),console.log(T),document.getElementById("main-form").reset(),y().close()}));let T=i("test");T.addTask(f),u.addFolder(T),c(T);let U=i("test2");U.addTask(p),U.addTask(f),U.addTask(k),U.deleteTask(p),u.addFolder(U),c(U),console.log(U)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGFBQUVDLEdEM0RwRCxXQUNJLE1BQU1DLEVBQU8xRSxTQUFTMEIsZUFBZSxhQUUvQmlELEVBQWtCRCxFQUFLVCxTQUFTLGNBQ2hDVyxFQUF3QkYsRUFBS1QsU0FBUyxvQkFDdENZLEVBQW9CSCxFQUFLVCxTQUFTLGlCQUNsQ2EsRUFBcUJKLEVBQUtULFNBQVMsaUJBT3pDLE1BQU8sQ0FBQ0ssVUFMUUssRUFBZ0IzRCxNQUtidUQsZ0JBSkdLLEVBQXNCNUQsTUFJUndELFlBSGxCSyxFQUFrQjdELE1BR2F5RCxhQUY5QkssRUFBbUI5RCxNQUcxQyxDQzZDb0UrRCxHQUcxREMsRUFBVW5ILEVBQUt5RyxFQUFXQyxFQUFpQkMsRUFBYUMsR0FDOURoQyxFQUFZQyxRQUFRL0MsU0FBUXVDLElBQ3BCbUMsSUFBd0JuQyxFQUFPbEQsY0FDL0JrRCxFQUFPaEQsUUFBUThGLEVBQ25CLElBSUp6QyxFQUEyQjhCLEdBQzNCeEYsUUFBUUMsSUFBSW1HLEdBR0tqRixTQUFTMEIsZUFBZSxhQUNoQ3dELFFBQ1QvQixJQUFnQmlCLE9BQ3BCLElBaUNBLElBQUlhLEVBQWFsRyxFQUFPLFFBQ3hCa0csRUFBVy9GLFFBQVE4RCxHQUNuQlAsRUFBWUUsVUFBVXNDLEdBQ3RCckQsRUFBYXFELEdBRWIsSUFBSUUsRUFBY3BHLEVBQU8sU0FDekJvRyxFQUFZakcsUUFBUStELEdBQ3BCa0MsRUFBWWpHLFFBQVE4RCxHQUNwQm1DLEVBQVlqRyxRQUFRZ0UsR0FDcEJpQyxFQUFZN0YsV0FBVzJELEdBQ3ZCUixFQUFZRSxVQUFVd0MsR0FDdEJ2RCxFQUFhdUQsR0FFYnRHLFFBQVFDLElBQUlxRyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1saXN0L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3RvZG8tbGlzdC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0L3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9uYXRpdmUuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9ybmcuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9zdHJpbmdpZnkuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9mYWN0b3JpZXMuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvZG9tLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImNvbnN0IHJhbmRvbVVVSUQgPSB0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8ucmFuZG9tVVVJRCAmJiBjcnlwdG8ucmFuZG9tVVVJRC5iaW5kKGNyeXB0byk7XG5leHBvcnQgZGVmYXVsdCB7XG4gIHJhbmRvbVVVSURcbn07IiwiLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gSW4gdGhlIGJyb3dzZXIgd2UgdGhlcmVmb3JlXG4vLyByZXF1aXJlIHRoZSBjcnlwdG8gQVBJIGFuZCBkbyBub3Qgc3VwcG9ydCBidWlsdC1pbiBmYWxsYmFjayB0byBsb3dlciBxdWFsaXR5IHJhbmRvbSBudW1iZXJcbi8vIGdlbmVyYXRvcnMgKGxpa2UgTWF0aC5yYW5kb20oKSkuXG5sZXQgZ2V0UmFuZG9tVmFsdWVzO1xuY29uc3Qgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBybmcoKSB7XG4gIC8vIGxhenkgbG9hZCBzbyB0aGF0IGVudmlyb25tZW50cyB0aGF0IG5lZWQgdG8gcG9seWZpbGwgaGF2ZSBhIGNoYW5jZSB0byBkbyBzb1xuICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgIC8vIGdldFJhbmRvbVZhbHVlcyBuZWVkcyB0byBiZSBpbnZva2VkIGluIGEgY29udGV4dCB3aGVyZSBcInRoaXNcIiBpcyBhIENyeXB0byBpbXBsZW1lbnRhdGlvbi5cbiAgICBnZXRSYW5kb21WYWx1ZXMgPSB0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChjcnlwdG8pO1xuXG4gICAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY3J5cHRvLmdldFJhbmRvbVZhbHVlcygpIG5vdCBzdXBwb3J0ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQjZ2V0cmFuZG9tdmFsdWVzLW5vdC1zdXBwb3J0ZWQnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbn0iLCJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG4vKipcbiAqIENvbnZlcnQgYXJyYXkgb2YgMTYgYnl0ZSB2YWx1ZXMgdG8gVVVJRCBzdHJpbmcgZm9ybWF0IG9mIHRoZSBmb3JtOlxuICogWFhYWFhYWFgtWFhYWC1YWFhYLVhYWFgtWFhYWFhYWFhYWFhYXG4gKi9cblxuY29uc3QgYnl0ZVRvSGV4ID0gW107XG5cbmZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgYnl0ZVRvSGV4LnB1c2goKGkgKyAweDEwMCkudG9TdHJpbmcoMTYpLnNsaWNlKDEpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuc2FmZVN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgLy8gTm90ZTogQmUgY2FyZWZ1bCBlZGl0aW5nIHRoaXMgY29kZSEgIEl0J3MgYmVlbiB0dW5lZCBmb3IgcGVyZm9ybWFuY2VcbiAgLy8gYW5kIHdvcmtzIGluIHdheXMgeW91IG1heSBub3QgZXhwZWN0LiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkL3B1bGwvNDM0XG4gIHJldHVybiBieXRlVG9IZXhbYXJyW29mZnNldCArIDBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDNdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA1XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDZdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgN11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA4XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDldXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTNdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTVdXTtcbn1cblxuZnVuY3Rpb24gc3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICBjb25zdCB1dWlkID0gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0KTsgLy8gQ29uc2lzdGVuY3kgY2hlY2sgZm9yIHZhbGlkIFVVSUQuICBJZiB0aGlzIHRocm93cywgaXQncyBsaWtlbHkgZHVlIHRvIG9uZVxuICAvLyBvZiB0aGUgZm9sbG93aW5nOlxuICAvLyAtIE9uZSBvciBtb3JlIGlucHV0IGFycmF5IHZhbHVlcyBkb24ndCBtYXAgdG8gYSBoZXggb2N0ZXQgKGxlYWRpbmcgdG9cbiAgLy8gXCJ1bmRlZmluZWRcIiBpbiB0aGUgdXVpZClcbiAgLy8gLSBJbnZhbGlkIGlucHV0IHZhbHVlcyBmb3IgdGhlIFJGQyBgdmVyc2lvbmAgb3IgYHZhcmlhbnRgIGZpZWxkc1xuXG4gIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ1N0cmluZ2lmaWVkIFVVSUQgaXMgaW52YWxpZCcpO1xuICB9XG5cbiAgcmV0dXJuIHV1aWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHN0cmluZ2lmeTsiLCJpbXBvcnQgbmF0aXZlIGZyb20gJy4vbmF0aXZlLmpzJztcbmltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IHsgdW5zYWZlU3RyaW5naWZ5IH0gZnJvbSAnLi9zdHJpbmdpZnkuanMnO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBpZiAobmF0aXZlLnJhbmRvbVVVSUQgJiYgIWJ1ZiAmJiAhb3B0aW9ucykge1xuICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICB9XG5cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gdW5zYWZlU3RyaW5naWZ5KHJuZHMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2NDsiLCJpbXBvcnQge3Y0IGFzIHV1aWR2NH0gZnJvbSAndXVpZCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBUYXNrKHRpdGxlLCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSwgcHJpb3JpdHkpIHtcblxuICAgIGxldCBteVRhc2tVdWlkID0gdXVpZHY0KCk7XG5cbiAgICBsZXQgY29tcGxldGVTdGF0ZSA9IGZhbHNlO1xuXG4gICAgY29uc3QgZ2V0Q29tcGxldGVTdGF0ZSA9ICgpID0+IGNvbXBsZXRlU3RhdGU7XG5cbiAgICBjb25zdCBzZXRDb21wbGV0ZSA9ICgpID0+IHtcbiAgICAgICAgY29tcGxldGVTdGF0ZSA9IHRydWU7XG4gICAgfVxuICAgIHRpdGxlID0gdGl0bGUudG9TdHJpbmcoKTtcbiAgICBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uLnRvU3RyaW5nKCk7XG5cbiAgICBjb25zdCBjaGFuZ2VQcmlvcml0eSA9IChuZXdQcmlvcml0eSkgPT4ge1xuICAgICAgICBwcmlvcml0eSA9IG5ld1ByaW9yaXR5O1xuICAgIH1cblxuICAgIGNvbnN0IGVkaXRUYXNrID0gKG5ld1RpdGxlLCBuZXdEZXNjcmlwdGlvbiwgbmV3RHVlRGF0ZSwgbmV3UHJpb3JpdHkpID0+IHtcbiAgICAgICAgdGl0bGUgPSBuZXdUaXRsZTtcbiAgICAgICAgZGVzY3JpcHRpb24gPSBuZXdEZXNjcmlwdGlvbjtcbiAgICAgICAgZHVlRGF0ZSA9IG5ld0R1ZURhdGU7XG4gICAgICAgIGNoYW5nZVByaW9yaXR5KG5ld1ByaW9yaXR5KTtcbiAgICB9XG5cbiAgICBjb25zdCBwcmludFRhc2sgPSAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBUYXNrIHRpdGxlIC0gJHt0aXRsZX0sIERlc2MgLSAke2Rlc2NyaXB0aW9ufSwgRGF0ZSAtICR7ZHVlRGF0ZX0sIFByaW9yaXR5IC0gJHtwcmlvcml0eX1gKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBnZXQgdGl0bGUoKSB7cmV0dXJuIHRpdGxlfSwgXG4gICAgICAgIGdldCBkZXNjcmlwdGlvbigpIHtyZXR1cm4gZGVzY3JpcHRpb259LCBcbiAgICAgICAgZ2V0IGR1ZURhdGUoKSB7cmV0dXJuIGR1ZURhdGV9LCBcbiAgICAgICAgZ2V0IHByaW9yaXR5KCkge3JldHVybiBwcmlvcml0eX0sXG4gICAgICAgIGdldENvbXBsZXRlU3RhdGUsXG4gICAgICAgIHNldENvbXBsZXRlLCBcbiAgICAgICAgY2hhbmdlUHJpb3JpdHksXG4gICAgICAgIGVkaXRUYXNrLFxuICAgICAgICBwcmludFRhc2ssXG4gICAgICAgIG15VGFza1V1aWRcbiAgICB9O1xufTtcblxuXG5leHBvcnQgZnVuY3Rpb24gRm9sZGVyKHRpdGxlKSB7XG4gICAgXG5cbiAgICBsZXQgbXlGb2xkZXJVdWlkID0gdXVpZHY0KCk7XG4gICAgbGV0IHRhc2tzID0gW107XG5cbiAgICBjb25zdCBhZGRUYXNrID0gKG5ld1Rhc2tOYW1lKSA9PiB7XG4gICAgICAgIHRhc2tzLnB1c2gobmV3VGFza05hbWUpO1xuICAgIH1cblxuICAgIGNvbnN0IGRpc3BsYXlUYXNrcyA9ICgpID0+IHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YXNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFRhc2sgJHtpfSAtICR7dGFza3NbaV0udGl0bGV9LCAke3Rhc2tzW2ldLmR1ZURhdGV9LCAke3Rhc2tzW2ldLnByaW9yaXR5fWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgZGVsZXRlVGFzayA9ICh0YXNrTmFtZSkgPT4ge1xuICAgICAgICAvLyB0YXNrcy5zcGxpY2UodGFza05hbWUsIDEpO1xuICAgICAgICBmb3IgKGxldCBpID0gdGFza3MubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgICAgIGlmICh0YXNrc1tpXS5teVRhc2tVdWlkID09PSB0YXNrTmFtZS5teVRhc2tVdWlkKSB7XG4gICAgICAgICAgICAgICAgdGFza3Muc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgXG4gICAgcmV0dXJuIHt0aXRsZSwgdGFza3MsIG15Rm9sZGVyVXVpZCwgYWRkVGFzaywgZGlzcGxheVRhc2tzLCBkZWxldGVUYXNrfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFN1cGVyRm9sZGVyKCkge1xuICAgIGxldCBmb2xkZXJzID0gW11cblxuICAgIGNvbnN0IGFkZEZvbGRlciA9IChuZXdGb2xkZXJOYW1lKSA9PiB7XG4gICAgICAgIGZvbGRlcnMucHVzaChuZXdGb2xkZXJOYW1lKTtcbiAgICB9XG5cbiAgICBjb25zdCBkZWxldGVGb2xkZXIgPSAoZm9sZGVyTmFtZSkgPT4ge1xuICAgICAgICBmb3IgKGxldCBpID0gZm9sZGVycy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICAgICAgaWYgKGZvbGRlcnNbaV0ubXlGb2xkZXJVdWlkID09PSBmb2xkZXJOYW1lLm15Rm9sZGVyVXVpZCkge1xuICAgICAgICAgICAgICAgIGZvbGRlcnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtmb2xkZXJzLCBhZGRGb2xkZXIsIGRlbGV0ZUZvbGRlcn1cbn0iLCJpbXBvcnQge1xuICAgIGRpc3BsYXlDdXJyZW50Rm9sZGVyV2l0aElkLFxuICAgIGRlbGV0ZUZvbGRlcldpdGhJZCxcbiAgICBkZWxldGVUYXNrV2l0aElkLFxuICAgIGNoYW5nZVRhc2tTdGF0dXNcbn0gZnJvbSAnLi4vaW5kZXguanMnO1xuXG5cbi8vIENyZWF0ZSBhbGwgZWxlbWVudHMgZm9yIGVhY2ggdGFzayBwcm9wZXJ0eSBhbmQgY2hhbmdlIHRleHQgY29udGVudCB0byBjb3JyZXNwb25kaW5nIHZhbHVlXG4vLyBUaGVuIGFkZCB0aGVtIHRvIGEgbWFpbiBkaXYgYW5kIHJldHVyblxuZnVuY3Rpb24gY3JlYXRlVGFza0VsZW1lbnQodGFza05hbWUpIHtcbiAgICBjb25zdCB0YXNrRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgdGFza1RpdGxlSW5EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgY29uc3QgdGFza0Rlc2NyaXB0aW9uSW5EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgY29uc3QgdGFza0R1ZURhdGVJbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBjb25zdCB0YXNrUHJpb3JpdHlJbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBcbiAgICB0YXNrRGl2LmNsYXNzTGlzdC5hZGQoJ3Rhc2stZGl2Jyk7XG4gICAgdGFza1RpdGxlSW5EaXYudGV4dENvbnRlbnQgPSB0YXNrTmFtZS50aXRsZTtcbiAgICB0YXNrRGVzY3JpcHRpb25JbkRpdi50ZXh0Q29udGVudCA9IHRhc2tOYW1lLmRlc2NyaXB0aW9uO1xuICAgIHRhc2tEdWVEYXRlSW5EaXYudGV4dENvbnRlbnQgPSB0YXNrTmFtZS5kdWVEYXRlO1xuICAgIHRhc2tQcmlvcml0eUluRGl2LnRleHRDb250ZW50ID0gdGFza05hbWUucHJpb3JpdHk7XG5cbiAgICB0YXNrRGl2LmFwcGVuZENoaWxkKHRhc2tUaXRsZUluRGl2KTtcbiAgICB0YXNrRGl2LmFwcGVuZENoaWxkKHRhc2tEZXNjcmlwdGlvbkluRGl2KTtcbiAgICB0YXNrRGl2LmFwcGVuZENoaWxkKHRhc2tEdWVEYXRlSW5EaXYpO1xuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza1ByaW9yaXR5SW5EaXYpO1xuICAgIGNyZWF0ZVRhc2tEZWxldGVCdXR0b24odGFza0RpdikudmFsdWUgPSB0YXNrTmFtZS5teVRhc2tVdWlkO1xuICAgIGNyZWF0ZVRhc2tFZGl0QnV0dG9uKHRhc2tEaXYpLnZhbHVlID0gdGFza05hbWUubXlUYXNrVXVpZDtcbiAgICBjcmVhdGVUYXNrU3RhdHVzQnV0dG9uKHRhc2tEaXYpLnZhbHVlID0gdGFza05hbWUubXlUYXNrVXVpZDtcblxuICAgIHJldHVybiB0YXNrRGl2O1xufVxuXG4vLyBUYWtlIGluIHRhc2sgYW5kIHdoZXJlIHRvIGFwcGVuZFxuLy8gQ3JlYXRlIHRoZSB0YXNrIHVzaW5nIGNyZWF0ZVRhc2tFbGVtZW50IGFuZCBhc3NpZ24gdG8gdmFyaWFibGVcbi8vIFRhcmdldCBlbGVtZW50IHRvIGFwcGVuZCB0byBhbmQgYXBwZW5kXG5mdW5jdGlvbiBhcHBlbmRUYXNrKHRhc2tOYW1lLCBsb2NhdGlvbikge1xuICAgIGxldCB0YXNrRE9NID0gY3JlYXRlVGFza0VsZW1lbnQodGFza05hbWUpO1xuXG4gICAgY29uc3QgbG9jYXRpb25ET00gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsb2NhdGlvbik7XG4gICAgbG9jYXRpb25ET00uYXBwZW5kQ2hpbGQodGFza0RPTSk7XG59XG5cbi8vIFRha2UgaW4gZm9sZGVyIG5hbWUgdGhlbiBsb29wIHRocm91Z2ggdGFza3MgaW5zaWRlIGZvbGRlciB0byBhcHBlbmQgdG8gc2NyZWVuXG5mdW5jdGlvbiBkaXNwbGF5Rm9sZGVyVGFza3MoZm9sZGVyTmFtZSkge1xuICAgIGZvbGRlck5hbWUudGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgYXBwZW5kVGFzayh0YXNrLCBbJ3Rhc2stY29udGFpbmVyJ10pO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRUYXNrRm9ybUluZm8oKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluLWZvcm0nKTtcblxuICAgIGNvbnN0IHRhc2tUaXRsZUluRm9ybSA9IGZvcm0uZWxlbWVudHNbJ3Rhc2stdGl0bGUnXTtcbiAgICBjb25zdCB0YXNrRGVzY3JpcHRpb25JbkZvcm0gPSBmb3JtLmVsZW1lbnRzWyd0YXNrLWRlc2NyaXB0aW9uJ107XG4gICAgY29uc3QgdGFza0R1ZURhdGVJbkZvcm0gPSBmb3JtLmVsZW1lbnRzWyd0YXNrLWR1ZS1kYXRlJ107XG4gICAgY29uc3QgdGFza1ByaW9yaXR5SW5Gb3JtID0gZm9ybS5lbGVtZW50c1sndGFzay1wcmlvcml0eSddO1xuICAgIFxuICAgIGxldCB0YXNrVGl0bGUgPSB0YXNrVGl0bGVJbkZvcm0udmFsdWU7XG4gICAgbGV0IHRhc2tEZXNjcmlwdGlvbiA9IHRhc2tEZXNjcmlwdGlvbkluRm9ybS52YWx1ZTtcbiAgICBsZXQgdGFza0R1ZURhdGUgPSB0YXNrRHVlRGF0ZUluRm9ybS52YWx1ZTtcbiAgICBsZXQgdGFza1ByaW9yaXR5ID0gdGFza1ByaW9yaXR5SW5Gb3JtLnZhbHVlO1xuXG4gICAgcmV0dXJuIHt0YXNrVGl0bGUsIHRhc2tEZXNjcmlwdGlvbiwgdGFza0R1ZURhdGUsIHRhc2tQcmlvcml0eX07XG59IFxuXG4vLyBDcmVhdGUgYnV0dG9uIHRvIGhvbGQgZm9sZGVyIGFuZCB0aXRsZVxuLy8gQWRkIHRpdGxlIHRvIGRpdiBhbmQgcmV0dXJuXG5mdW5jdGlvbiBjcmVhdGVGb2xkZXJCdXR0b24oZm9sZGVyTmFtZSkge1xuICAgIGNvbnN0IHNpZGViYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2lkZWJhcicpO1xuICAgIGNvbnN0IGZvbGRlckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IGZvbGRlckJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuXG4gICAgZm9sZGVyRGl2LmNsYXNzTGlzdC5hZGQoJ2ZvbGRlci1kaXYnKTtcbiAgICBmb2xkZXJCdG4uY2xhc3NMaXN0LmFkZCgnZm9sZGVyLWJ1dHRvbicpO1xuICAgIGZvbGRlckJ0bi50ZXh0Q29udGVudCA9IGZvbGRlck5hbWUudGl0bGU7XG4gICAgZm9sZGVyQnRuLnZhbHVlID0gZm9sZGVyTmFtZS5teUZvbGRlclV1aWQ7XG5cbiAgICBmb2xkZXJEaXYuYXBwZW5kQ2hpbGQoZm9sZGVyQnRuKTtcbiAgICBcbiAgICAvLyBDcmVhdGUgdGhlIGRlbCBidG4gYW5kICBhc3NpZ24gc2FtZSBpZCBhcyBmb2xkZXIgdG8gaXRcbiAgICBjcmVhdGVGb2xkZXJEZWxldGVCdXR0b24oZm9sZGVyRGl2KS52YWx1ZSA9IGZvbGRlck5hbWUubXlGb2xkZXJVdWlkO1xuXG4gICAgc2lkZWJhci5hcHBlbmRDaGlsZChmb2xkZXJEaXYpO1xuXG4gICAgZm9sZGVyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBjdXJyZW50Rm9sZGVySWQgPSBmb2xkZXJOYW1lLm15Rm9sZGVyVXVpZDtcbiAgICAgICAgZGlzcGxheUN1cnJlbnRGb2xkZXJXaXRoSWQoZm9sZGVyTmFtZS5teUZvbGRlclV1aWQpO1xuICAgICAgICBjb25zb2xlLmxvZyhmb2xkZXJOYW1lLnRpdGxlLCBmb2xkZXJOYW1lLm15Rm9sZGVyVXVpZCk7XG4gICAgICAgIHJldHVybiBjdXJyZW50Rm9sZGVySWQ7XG4gICAgfSk7XG4gICAgXG4gICAgcmV0dXJuIGZvbGRlckRpdjtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRm9sZGVyRGVsZXRlQnV0dG9uKGZvbGRlcikge1xuICAgIGNvbnN0IGZvbGRlckRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuXG4gICAgZm9sZGVyRGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoJ2ZvbGRlci1kZWxldGUtYnRuJyk7XG4gICAgZm9sZGVyRGVsZXRlQnRuLnRleHRDb250ZW50ID0gJy0nO1xuXG4gICAgZm9sZGVyLmFwcGVuZENoaWxkKGZvbGRlckRlbGV0ZUJ0bik7XG5cbiAgICBmb2xkZXJEZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGxldCB0aGlzQnV0dG9uID0gZS50YXJnZXQ7XG4gICAgICAgIGRlbGV0ZUZvbGRlcldpdGhJZCh0aGlzQnV0dG9uLnZhbHVlKTtcbiAgICAgICAgdGhpc0J1dHRvbi5wYXJlbnROb2RlLnJlbW92ZSgpO1xuICAgIH0pXG5cbiAgICByZXR1cm4gZm9sZGVyRGVsZXRlQnRuO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUYXNrRGVsZXRlQnV0dG9uKHRhc2spIHtcbiAgICBjb25zdCB0YXNrRGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cbiAgICB0YXNrRGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoJ3Rhc2stZGVsZXRlLWJ0bicpO1xuICAgIHRhc2tEZWxldGVCdG4udGV4dENvbnRlbnQgPSAnLSc7XG5cbiAgICB0YXNrLmFwcGVuZENoaWxkKHRhc2tEZWxldGVCdG4pO1xuXG4gICAgdGFza0RlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgbGV0IHRoaXNCdXR0b24gPSBlLnRhcmdldDtcbiAgICAgICAgZGVsZXRlVGFza1dpdGhJZCh0aGlzQnV0dG9uLnZhbHVlKTtcbiAgICAgICAgdGhpc0J1dHRvbi5wYXJlbnROb2RlLnJlbW92ZSgpO1xuICAgIH0pXG5cbiAgICByZXR1cm4gdGFza0RlbGV0ZUJ0bjtcbn1cblxuZnVuY3Rpb24gY3JlYXRlVGFza0VkaXRCdXR0b24odGFzaykge1xuICAgIGNvbnN0IHRhc2tFZGl0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cbiAgICB0YXNrRWRpdEJ0bi5jbGFzc0xpc3QuYWRkKCd0YXNrLWVkaXQtYnRuJyk7XG4gICAgdGFza0VkaXRCdG4udGV4dENvbnRlbnQgPSAnKyc7XG5cbiAgICB0YXNrLmFwcGVuZENoaWxkKHRhc2tFZGl0QnRuKTtcblxuICAgIHRhc2tFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIFxuICAgIH0pXG5cbiAgICByZXR1cm4gdGFza0VkaXRCdG47XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVRhc2tTdGF0dXNCdXR0b24odGFzaykge1xuICAgIGNvbnN0IHRhc2tTdGF0dXNCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcblxuICAgIHRhc2tTdGF0dXNCdG4uY2xhc3NMaXN0LmFkZCgndGFzay1zdGF0dXMtYnRuJyk7XG4gICAgdGFza1N0YXR1c0J0bi50ZXh0Q29udGVudCA9ICfinJQnO1xuXG4gICAgdGFzay5hcHBlbmRDaGlsZCh0YXNrU3RhdHVzQnRuKTtcblxuICAgIHRhc2tTdGF0dXNCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGxldCB0aGlzQnV0dG9uID0gZS50YXJnZXQ7XG4gICAgICAgIGNoYW5nZVRhc2tTdGF0dXModGhpc0J1dHRvbi52YWx1ZSk7XG4gICAgICAgIFxuICAgIH0pXG5cbiAgICByZXR1cm4gdGFza1N0YXR1c0J0bjtcbn1cblxuLy8gVGFrZSBpbiBmb2xkZXIgbmFtZSBhbmQgY3JlYXRlIGZvbGRlciB1c2luZyBmdW5jdGlvblxuLy8gQXBwZW5kIHRvIHNpZGViYXJcbmZ1bmN0aW9uIGFwcGVuZEZvbGRlcihmb2xkZXJOYW1lKSB7XG4gICAgbGV0IGZvbGRlckRPTSA9IGNyZWF0ZUZvbGRlckJ1dHRvbihmb2xkZXJOYW1lKTtcbiAgICBcbiAgICBjb25zdCBzaWRlYmFyRm9sZGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaWRlYmFyJyk7XG4gICAgc2lkZWJhckZvbGRlcnMuYXBwZW5kQ2hpbGQoZm9sZGVyRE9NKTtcbn1cblxuLy8gVGFrZSBpbiBzdXBlciBmb2xkZXIgbmFtZSB0byBsb29wIHRocm91Z2ggZWFjaCBmb2xkZXIgYW5kIGFwcGVuZCB0byBzaWRlYmFyXG5mdW5jdGlvbiBkaXNwbGF5Rm9sZGVycyhzdXBlckZvbGRlck5hbWUpIHtcbiAgICAvLyBjbGVhclNpZGViYXIoKTtcbiAgICBzdXBlckZvbGRlck5hbWUuZm9sZGVycy5mb3JFYWNoKGZvbGRlciA9PiB7XG4gICAgICAgIGFwcGVuZEZvbGRlcihmb2xkZXIpO1xuICAgIH0pO1xufVxuXG5cbmZ1bmN0aW9uIGdldEZvbGRlckZvcm1JbmZvKCkge1xuICAgIGNvbnN0IGZvbGRlckZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZGVyLWZvcm0nKTtcblxuICAgIGNvbnN0IGZvbGRlclRpdGxlSW5Gb3JtID0gZm9sZGVyRm9ybS5lbGVtZW50c1snZm9sZGVyLXRpdGxlJ10udmFsdWU7XG5cbiAgICByZXR1cm4ge2ZvbGRlckZvcm0sIGZvbGRlclRpdGxlSW5Gb3JtfTtcbn1cblxuZnVuY3Rpb24gY2xlYXJUYXNrQ29udGFpbmVyKCkge1xuICAgIGNvbnN0IHRhc2tDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFzay1jb250YWluZXInKTtcblxuICAgIHRhc2tDb250YWluZXIudGV4dENvbnRlbnQgPSAnJztcbn1cblxuZnVuY3Rpb24gYXBwZW5kRHJvcGRvd24oc3VwZXJGb2xkZXIpIHtcbiAgICBsZXQgaW5kZXggPSAwO1xuICAgIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXItc2VsZWN0aW9uJyk7XG5cbiAgICBjbGVhclNlbGVjdE1lbnUoc2VsZWN0KTtcblxuICAgIHN1cGVyRm9sZGVyLmZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgICAgXG4gICAgICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IGZvbGRlci50aXRsZTtcbiAgICAgICAgb3B0aW9uLnZhbHVlID0gZm9sZGVyLm15Rm9sZGVyVXVpZDsgLy8gZmlndXJlIG91dCBpZiB0aGlzIGlzIGdvb2Qgd2F5IHRvIHNlbGVjdFxuICAgICAgICAvLyBvcHRpb24uc2V0QXR0cmlidXRlKCdpbmRleCcsIGluZGV4KyspO1xuXG4gICAgICAgIHNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb24pO1xuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGNsZWFyU2VsZWN0TWVudShzZWxlY3RPcHRpb24pIHtcbiAgICBmb3IgKGxldCBpID0gc2VsZWN0T3B0aW9uLm9wdGlvbnMubGVuZ3RoOyBpID49IDA7IGktLSkge1xuICAgICAgICBzZWxlY3RPcHRpb24ucmVtb3ZlKDApO1xuICAgIH1cbn1cblxuZXhwb3J0IHtcbiAgICBnZXRUYXNrRm9ybUluZm8sXG4gICAgZ2V0Rm9sZGVyRm9ybUluZm8sXG4gICAgY3JlYXRlVGFza0VsZW1lbnQsXG4gICAgY3JlYXRlRm9sZGVyQnV0dG9uLFxuICAgIGFwcGVuZEZvbGRlcixcbiAgICBkaXNwbGF5Rm9sZGVyVGFza3MsXG4gICAgYXBwZW5kVGFzayxcbiAgICBkaXNwbGF5Rm9sZGVycyxcbiAgICBjbGVhclRhc2tDb250YWluZXIsXG4gICAgYXBwZW5kRHJvcGRvd24sXG4gICAgY2xlYXJTZWxlY3RNZW51XG59IiwiaW1wb3J0IHtcbiAgICBUYXNrLFxuICAgIEZvbGRlcixcbiAgICBTdXBlckZvbGRlclxufSBmcm9tICcuL21vZHVsZXMvZmFjdG9yaWVzLmpzJztcblxuaW1wb3J0IHtcbiAgICBnZXRUYXNrRm9ybUluZm8sXG4gICAgZ2V0Rm9sZGVyRGlhbG9nLFxuICAgIGdldEZvbGRlckZvcm1JbmZvLFxuICAgIGNyZWF0ZVRhc2tFbGVtZW50LFxuICAgIGNyZWF0ZUZvbGRlckJ1dHRvbixcbiAgICBhcHBlbmRGb2xkZXIsXG4gICAgZGlzcGxheUZvbGRlclRhc2tzLFxuICAgIGFwcGVuZFRhc2ssXG4gICAgZGlzcGxheUZvbGRlcnMsXG4gICAgY2xlYXJUYXNrQ29udGFpbmVyLFxuICAgIGFwcGVuZERyb3Bkb3duLFxuICAgIGNsZWFyU2VsZWN0TWVudVxuXG59IGZyb20gJy4vbW9kdWxlcy9kb20uanMnO1xuXG4vL1N1cGVyIEZvbGRlciBcbmNvbnN0IHN1cGVyRm9sZGVyID0gU3VwZXJGb2xkZXIoKTtcblxuLy8gTWFpbiBGb2xkZXIgdGhhdCB0YXNrcyB3aWxsIGdvIGludG9cbmNvbnN0IGluYm94Rm9sZGVyID0gRm9sZGVyKCdJbmJveCcpO1xuXG4vLyBUZXN0IHRhc2tzXG5jb25zdCB0YXNrMSA9IFRhc2soJ2Nob3JlcycsICd3YXNoIGRpc2hlcycsICdub3YgMjMnLCAnaGlnaCcpO1xuY29uc3QgdGFzazIgPSBUYXNrKCdtb3ZpZXMnLCAnYXZhdGFyJywgJ25vdiAyOScsICdtZWQnKTtcbmNvbnN0IHRhc2szID0gVGFzaygnY29kaW5nJywgJ3RvZG8gbGlzdCcsICdkZWMgMTAnLCAnbG93Jyk7XG5cbnRhc2sxLmVkaXRUYXNrKCduZXcgdGhpbmcnLCAnYW5vdGhlciBuZXcgdGhpbmcnLCAnbmV3IGRhdGUnLCAnSElHSCcpO1xuXG4vLyBUZXN0aW5nIGZ1bmN0aW9uYWxpdGllc1xuaW5ib3hGb2xkZXIuYWRkVGFzayh0YXNrMyk7XG5pbmJveEZvbGRlci5hZGRUYXNrKHRhc2syKTtcbmluYm94Rm9sZGVyLmFkZFRhc2sodGFzazEpO1xuaW5ib3hGb2xkZXIuZGlzcGxheVRhc2tzKCk7XG5zdXBlckZvbGRlci5hZGRGb2xkZXIoaW5ib3hGb2xkZXIpO1xuY29uc29sZS5sb2coc3VwZXJGb2xkZXIpO1xuXG4vLyBPcGVuIHRhc2sgbW9kYWwgd2hlbiBjbGlja2VkXG5jb25zdCBvcGVuVGFza01vZGFsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW4tdGFzay1tb2RhbC1idG4nKTtcbm9wZW5UYXNrTW9kYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcblxuICAgIGdldFRhc2tEaWFsb2coKS5zaG93TW9kYWwoKTtcbiAgICBhcHBlbmREcm9wZG93bihzdXBlckZvbGRlcik7XG59KTtcblxuLy8gR2V0IHRhc2sgZGlhbG9nIGFuZCByZXR1cm4gXG5mdW5jdGlvbiBnZXRUYXNrRGlhbG9nKCkge1xuICAgIGNvbnN0IHRhc2tEaWFsb2cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFzay1kaWFsb2cnKTtcblxuICAgIHJldHVybiB0YXNrRGlhbG9nO1xufVxuXG4vLyBPcGVuIGZvbGRlciBtb2RhbCB3aGVuIGNsaWNrZWRcbmNvbnN0IGFkZEZvbGRlckJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXItYWRkLWJ0bicpO1xuYWRkRm9sZGVyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgY29uc3QgZm9sZGVyRGlhbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRlci1kaWFsb2cnKTtcbiAgICBmb2xkZXJEaWFsb2cuc2hvd01vZGFsKCk7XG4gICAgXG59KTtcblxuLy8gRXZlbnQgbGlzdGVuZXIgdG8gc3VibWl0IGZvbGRlciBmb3JtXG4vLyBDcmVhdGUgYSBuZXcgZm9sZGVyIGluc3RhbmNlIHdpdGggaW5mbyBmcm9tIGZvcm1cbi8vIEFkZCB0byBET01cbi8vIEFkZCB0byBzdXBlciBmb2xkZXJcbi8vIFNob3VsZCBiZSBkb25lIG9uIHRoZSBmb3JtIGluc3RlYWQgb2YgYnV0dG9uIGJ1dCBNRE4gZXhhbXBsZSB3aXRoIGRpYWxvZyBkaWQgaXQgdGhpcyB3YXlcbmNvbnN0IGZvbGRlclN1Ym1pdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXItY29uZmlybS1idG4nKTtcbmZvbGRlclN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgXG4gICAgY29uc3QgZm9sZGVyRGlhbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRlci1kaWFsb2cnKTtcbiAgICBjb25zdCB7Zm9sZGVyVGl0bGVJbkZvcm19ID0gZ2V0Rm9sZGVyRm9ybUluZm8oKTtcblxuICAgIGxldCBuZXdGb2xkZXIgPSBGb2xkZXIoZm9sZGVyVGl0bGVJbkZvcm0pO1xuICAgIGFwcGVuZEZvbGRlcihuZXdGb2xkZXIpO1xuICAgIFxuICAgIHN1cGVyRm9sZGVyLmFkZEZvbGRlcihuZXdGb2xkZXIpO1xuICAgIGNvbnNvbGUubG9nKHN1cGVyRm9sZGVyLmZvbGRlcnMpO1xuXG4gICAgZm9sZGVyRGlhbG9nLmNsb3NlKCk7XG59KTtcblxuLy8gR28gdGhyb3VnaCBhbGwgZm9sZGVycyBhbmQgY2hlY2sgaWYgdGhlIGNsaWNrZWQgYnV0dG9uIHZhbHVlIG1hdGNoZXMgZm9sZGVyIHZhbHVlXG4vLyB0aGVuIGRpc3BsYXkgdGFza3Mgb2YgdGhhdCBmb2xkZXIgdG8gc2NyZWVuXG5mdW5jdGlvbiBkaXNwbGF5Q3VycmVudEZvbGRlcldpdGhJZCh0ZW1wSWQpIHtcbiAgICAvLyBsZXQgdGVtcElkID0gdGhpcy52YWx1ZTtcbiAgICBzdXBlckZvbGRlci5mb2xkZXJzLmZvckVhY2goZm9sZGVyID0+IHtcbiAgICAgICAgaWYgKHRlbXBJZCA9PT0gZm9sZGVyLm15Rm9sZGVyVXVpZCkge1xuICAgICAgICAgICAgY2xlYXJUYXNrQ29udGFpbmVyKCk7XG4gICAgICAgICAgICAvL2Rpc3BsYXkgYWxsIHRhc2tzIG9mIHRoaXMgZm9sZGVyIHRvIHBhZ2VcbiAgICAgICAgICAgIGRpc3BsYXlGb2xkZXJUYXNrcyhmb2xkZXIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJtYXRjaCBmb3VuZFwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5jb25zdCB0YXNrQWRkQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stYWRkLWJ0bicpO1xuLy8gQ3JlYXRlIG5ldyB0YXNrIGluc3RhbmNlIHVzaW5nIGluZm8gZnJvbSBmb3JtXG50YXNrQWRkQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgIC8vIEdldCB2YWx1ZSBvZiB0aGUgc2VsZWN0ZWQgZmllbGQgKElkIGJlY2F1c2UgdmFsdWUgaXMgc2V0IHRvIGlkIGluIGRvbS5qcylcbiAgICBjb25zdCBzZWxlY3RlZEZvbGRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXItc2VsZWN0aW9uJyk7XG4gICAgY29uc3Qgc2VsZWN0ZWRGb2xkZXJWYWx1ZSA9IHNlbGVjdGVkRm9sZGVyLnZhbHVlO1xuICAgIC8vIEdldCB2YWx1ZXMgb2YgdGhlIGZvcm1cbiAgICBjb25zdCB7dGFza1RpdGxlLCB0YXNrRGVzY3JpcHRpb24sIHRhc2tEdWVEYXRlLCB0YXNrUHJpb3JpdHl9ID0gZ2V0VGFza0Zvcm1JbmZvKCk7XG5cbiAgICAvLyBDcmVhdGUgbmV3IHRhc2sgYW5kIGxvb3AgdGhyb3VnaCBmb2xkZXIgdG8gZmluZCBtYXRjaGluZyBJZCBhbmQgYWRkXG4gICAgY29uc3QgbmV3VGFzayA9IFRhc2sodGFza1RpdGxlLCB0YXNrRGVzY3JpcHRpb24sIHRhc2tEdWVEYXRlLCB0YXNrUHJpb3JpdHkpO1xuICAgIHN1cGVyRm9sZGVyLmZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xuICAgICAgICBpZiAoc2VsZWN0ZWRGb2xkZXJWYWx1ZSA9PT0gZm9sZGVyLm15Rm9sZGVyVXVpZCkge1xuICAgICAgICAgICAgZm9sZGVyLmFkZFRhc2sobmV3VGFzayk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFVwZGF0ZSB0aGUgdGFza3Mgb2YgdGhlIGZvbGRlciB0aGF0IGlzIGN1cnJlbnRseSBiZWluZyBkaXNwbGF5ZWQgdG8gYXZvaWQgcmVsb2FkaW5nIGZvbGRlclxuICAgIGRpc3BsYXlDdXJyZW50Rm9sZGVyV2l0aElkKHNlbGVjdGVkRm9sZGVyVmFsdWUpO1xuICAgIGNvbnNvbGUubG9nKHRlc3RGb2xkZXIpO1xuXG4gICAgLy8gQ2xlYXIgZm9ybSBmaWVsZHNcbiAgICBjb25zdCB0YXNrRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluLWZvcm0nKTtcbiAgICB0YXNrRm9ybS5yZXNldCgpO1xuICAgIGdldFRhc2tEaWFsb2coKS5jbG9zZSgpO1xufSlcblxuZnVuY3Rpb24gZGVsZXRlRm9sZGVyV2l0aElkKGJ1dHRvbklkKSB7XG4gICAgc3VwZXJGb2xkZXIuZm9sZGVycy5mb3JFYWNoKGZvbGRlciA9PiB7XG4gICAgICAgIGlmIChidXR0b25JZCA9PT0gZm9sZGVyLm15Rm9sZGVyVXVpZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYnV0dG9uSWQpO1xuICAgICAgICAgICAgc3VwZXJGb2xkZXIuZGVsZXRlRm9sZGVyKGZvbGRlcik7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlVGFza1dpdGhJZChidXR0b25JZCkge1xuICAgIHN1cGVyRm9sZGVyLmZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xuICAgICAgICBmb2xkZXIudGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgICAgIGlmIChidXR0b25JZCA9PT0gdGFzay5teVRhc2tVdWlkKSB7XG4gICAgICAgICAgICAgICAgZm9sZGVyLmRlbGV0ZVRhc2sodGFzayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNoYW5nZVRhc2tTdGF0dXModGFza0lkKSB7XG4gICAgc3VwZXJGb2xkZXIuZm9sZGVycy5mb3JFYWNoKGZvbGRlciA9PiB7XG4gICAgICAgIGZvbGRlci50YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICAgICAgaWYgKHRhc2tJZCA9PT0gdGFzay5teVRhc2tVdWlkKSB7XG4gICAgICAgICAgICAgICAgdGFzay5zZXRDb21wbGV0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKHRhc2sxLmdldENvbXBsZXRlU3RhdGUoKSk7XG59XG5cblxubGV0IHRlc3RGb2xkZXIgPSBGb2xkZXIoJ3Rlc3QnKTtcbnRlc3RGb2xkZXIuYWRkVGFzayh0YXNrMSk7XG5zdXBlckZvbGRlci5hZGRGb2xkZXIodGVzdEZvbGRlcik7XG5hcHBlbmRGb2xkZXIodGVzdEZvbGRlcik7XG5cbmxldCB0ZXN0Rm9sZGVyMiA9IEZvbGRlcigndGVzdDInKTtcbnRlc3RGb2xkZXIyLmFkZFRhc2sodGFzazIpO1xudGVzdEZvbGRlcjIuYWRkVGFzayh0YXNrMSk7XG50ZXN0Rm9sZGVyMi5hZGRUYXNrKHRhc2szKTtcbnRlc3RGb2xkZXIyLmRlbGV0ZVRhc2sodGFzazIpO1xuc3VwZXJGb2xkZXIuYWRkRm9sZGVyKHRlc3RGb2xkZXIyKTtcbmFwcGVuZEZvbGRlcih0ZXN0Rm9sZGVyMik7XG5cbmNvbnNvbGUubG9nKHRlc3RGb2xkZXIyKTtcblxuZXhwb3J0IHtcbiAgICBkaXNwbGF5Q3VycmVudEZvbGRlcldpdGhJZCxcbiAgICBkZWxldGVGb2xkZXJXaXRoSWQsXG4gICAgZGVsZXRlVGFza1dpdGhJZCxcbiAgICBjaGFuZ2VUYXNrU3RhdHVzXG59Il0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwicmFuZG9tVVVJRCIsImNyeXB0byIsImJpbmQiLCJnZXRSYW5kb21WYWx1ZXMiLCJybmRzOCIsIlVpbnQ4QXJyYXkiLCJybmciLCJFcnJvciIsImJ5dGVUb0hleCIsImkiLCJwdXNoIiwidG9TdHJpbmciLCJzbGljZSIsIm9wdGlvbnMiLCJidWYiLCJvZmZzZXQiLCJybmRzIiwicmFuZG9tIiwiYXJyIiwidW5zYWZlU3RyaW5naWZ5IiwiVGFzayIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJkdWVEYXRlIiwicHJpb3JpdHkiLCJteVRhc2tVdWlkIiwiY29tcGxldGVTdGF0ZSIsImNoYW5nZVByaW9yaXR5IiwibmV3UHJpb3JpdHkiLCJnZXRDb21wbGV0ZVN0YXRlIiwic2V0Q29tcGxldGUiLCJlZGl0VGFzayIsIm5ld1RpdGxlIiwibmV3RGVzY3JpcHRpb24iLCJuZXdEdWVEYXRlIiwicHJpbnRUYXNrIiwiY29uc29sZSIsImxvZyIsIkZvbGRlciIsIm15Rm9sZGVyVXVpZCIsInRhc2tzIiwiYWRkVGFzayIsIm5ld1Rhc2tOYW1lIiwiZGlzcGxheVRhc2tzIiwibGVuZ3RoIiwiZGVsZXRlVGFzayIsInRhc2tOYW1lIiwic3BsaWNlIiwiZGlzcGxheUZvbGRlclRhc2tzIiwiZm9sZGVyTmFtZSIsImZvckVhY2giLCJ0YXNrIiwibG9jYXRpb24iLCJ0YXNrRE9NIiwidGFza0RpdiIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInRhc2tUaXRsZUluRGl2IiwidGFza0Rlc2NyaXB0aW9uSW5EaXYiLCJ0YXNrRHVlRGF0ZUluRGl2IiwidGFza1ByaW9yaXR5SW5EaXYiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsImFwcGVuZENoaWxkIiwidGFza0RlbGV0ZUJ0biIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidGhpc0J1dHRvbiIsInRhcmdldCIsImRlbGV0ZVRhc2tXaXRoSWQiLCJ2YWx1ZSIsInBhcmVudE5vZGUiLCJyZW1vdmUiLCJjcmVhdGVUYXNrRGVsZXRlQnV0dG9uIiwidGFza0VkaXRCdG4iLCJjcmVhdGVUYXNrRWRpdEJ1dHRvbiIsInRhc2tTdGF0dXNCdG4iLCJjaGFuZ2VUYXNrU3RhdHVzIiwiY3JlYXRlVGFza1N0YXR1c0J1dHRvbiIsImNyZWF0ZVRhc2tFbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJhcHBlbmRUYXNrIiwiYXBwZW5kRm9sZGVyIiwiZm9sZGVyRE9NIiwic2lkZWJhciIsInF1ZXJ5U2VsZWN0b3IiLCJmb2xkZXJEaXYiLCJmb2xkZXJCdG4iLCJmb2xkZXIiLCJmb2xkZXJEZWxldGVCdG4iLCJkZWxldGVGb2xkZXJXaXRoSWQiLCJjcmVhdGVGb2xkZXJEZWxldGVCdXR0b24iLCJjdXJyZW50Rm9sZGVySWQiLCJkaXNwbGF5Q3VycmVudEZvbGRlcldpdGhJZCIsImNyZWF0ZUZvbGRlckJ1dHRvbiIsInN1cGVyRm9sZGVyIiwiZm9sZGVycyIsImFkZEZvbGRlciIsIm5ld0ZvbGRlck5hbWUiLCJkZWxldGVGb2xkZXIiLCJTdXBlckZvbGRlciIsImluYm94Rm9sZGVyIiwidGFzazEiLCJ0YXNrMiIsInRhc2szIiwiZ2V0VGFza0RpYWxvZyIsInRlbXBJZCIsImJ1dHRvbklkIiwidGFza0lkIiwic2hvd01vZGFsIiwic2VsZWN0Iiwic2VsZWN0T3B0aW9uIiwiY2xlYXJTZWxlY3RNZW51Iiwib3B0aW9uIiwiYXBwZW5kRHJvcGRvd24iLCJwcmV2ZW50RGVmYXVsdCIsImZvbGRlckRpYWxvZyIsImZvbGRlclRpdGxlSW5Gb3JtIiwiZm9sZGVyRm9ybSIsImVsZW1lbnRzIiwiZ2V0Rm9sZGVyRm9ybUluZm8iLCJuZXdGb2xkZXIiLCJjbG9zZSIsInNlbGVjdGVkRm9sZGVyVmFsdWUiLCJ0YXNrVGl0bGUiLCJ0YXNrRGVzY3JpcHRpb24iLCJ0YXNrRHVlRGF0ZSIsInRhc2tQcmlvcml0eSIsImZvcm0iLCJ0YXNrVGl0bGVJbkZvcm0iLCJ0YXNrRGVzY3JpcHRpb25JbkZvcm0iLCJ0YXNrRHVlRGF0ZUluRm9ybSIsInRhc2tQcmlvcml0eUluRm9ybSIsImdldFRhc2tGb3JtSW5mbyIsIm5ld1Rhc2siLCJ0ZXN0Rm9sZGVyIiwicmVzZXQiLCJ0ZXN0Rm9sZGVyMiJdLCJzb3VyY2VSb290IjoiIn0=