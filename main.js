(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{kj:()=>C,F5:()=>F,k3:()=>S,HA:()=>T,QP:()=>b,mo:()=>p});const t={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let n;const o=new Uint8Array(16);function d(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}const r=[];for(let e=0;e<256;++e)r.push((e+256).toString(16).slice(1));const l=function(e,n,o){if(t.randomUUID&&!n&&!e)return t.randomUUID();const l=(e=e||{}).random||(e.rng||d)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,n){o=o||0;for(let e=0;e<16;++e)n[o+e]=l[e];return n}return function(e,t=0){return r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]}(l)};function a(e,t,n,o,d=l()){let r=!1;const a=()=>r;e=e.toString(),t=t.toString();const s=e=>{o=e};return{get title(){return e},get description(){return t},get dueDate(){return n},get priority(){return o},getCompleteState:a,setComplete:()=>{r=0==a()},changePriority:s,editTask:(o,d,r,l)=>{e=o,t=d,n=r,s(l)},printTask:()=>{console.log(`Task title - ${e}, Desc - ${t}, Date - ${n}, Priority - ${o}`)},myTaskUuid:d}}function s(e,t=l()){let n=[];return{title:e,tasks:n,myFolderUuid:t,addTask:e=>{n.push(e)},displayTasks:()=>{for(let e=0;e<n.length;e++)console.log(`Task ${e} - ${n[e].title}, ${n[e].dueDate}, ${n[e].priority}`)},deleteTask:e=>{for(let t=n.length-1;t>=0;--t)n[t].myTaskUuid===e.myTaskUuid&&n.splice(t,1)}}}function i(e=l()){let t=[];return{folders:t,addFolder:e=>{t.push(e)},deleteFolder:e=>{for(let n=t.length-1;n>=0;--n)t[n].myFolderUuid===e.myFolderUuid&&t.splice(n,1);localStorage.removeItem(e.myFolderUuid)},mySuperFolderUuid:e}}function c(e){e.tasks.forEach((e=>{!function(e,t){let n=function(e){const t=document.createElement("div"),n=document.createElement("p"),o=document.createElement("p"),d=document.createElement("p"),r=document.createElement("p");return t.classList.add("task-div"),n.textContent=e.title,o.textContent=e.description,d.textContent=e.dueDate,r.textContent=e.priority,t.appendChild(n),t.appendChild(o),t.appendChild(d),t.appendChild(r),(function(e){const t=document.createElement("button");return t.classList.add("task-delete-btn"),t.textContent="-",e.appendChild(t),t.addEventListener("click",(function(e){let t=e.target;S(t.value),t.parentNode.remove()})),t}(t)).value=e.myTaskUuid,(function(e){const t=document.createElement("button");return t.classList.add("task-edit-btn"),t.textContent="+",e.appendChild(t),t.addEventListener("click",(function(e){const t=document.getElementById("edit-form"),n=document.createElement("button");n.classList.add("edit-btn-id"),n.value=e.target.value,t.appendChild(n),function(e){const t=document.getElementById("edit-form"),n=t.elements["task-title"],o=t.elements["task-description"],d=t.elements["task-due-date"],r=t.elements["task-priority"];n.value=e.title,o.value=e.description,d.value=e.dueDate,r.value=e.priority}(b(e.target.value)),p().showModal()})),t}(t)).value=e.myTaskUuid,(function(e){const t=document.createElement("button");return t.classList.add("task-status-btn"),t.textContent="âœ”",e.appendChild(t),t.addEventListener("click",(function(e){let t=e.target;var n;C(t.value),(n=t).parentNode.classList.contains("complete-task")?n.parentNode.classList.remove("complete-task"):n.parentNode.classList.add("complete-task")})),t}(t)).value=e.myTaskUuid,t}(e);document.getElementById(["task-container"]).appendChild(n)}(e)}))}function u(e){let t=function(e){const t=document.querySelector(".sidebar"),n=document.createElement("div"),o=document.createElement("button");return n.classList.add("folder-div"),o.classList.add("folder-button"),o.textContent=e.title,o.value=e.myFolderUuid,n.appendChild(o),(function(e){const t=document.createElement("button");return t.classList.add("folder-delete-btn"),t.textContent="-",e.appendChild(t),t.addEventListener("click",(function(e){let t=e.target;F(t.value),t.parentNode.remove()})),t}(n)).value=e.myFolderUuid,t.appendChild(n),o.addEventListener("click",(function(){let t=e.myFolderUuid;return T(e.myFolderUuid),console.log(e.title,e.myFolderUuid),t})),n}(e);document.querySelector(".sidebar").appendChild(t)}const m=i();function f(){return document.getElementById("task-dialog")}function p(){return document.getElementById("edit-dialog")}document.getElementById("open-task-modal-btn").addEventListener("click",(function(){f().reset,f().showModal(),function(e){const t=document.getElementById("folder-selection");!function(e){for(let t=e.options.length;t>=0;t--)e.remove(0)}(t),e.folders.forEach((e=>{const n=document.createElement("option");n.textContent=e.title,n.value=e.myFolderUuid,t.appendChild(n)}))}(m)})),document.getElementById("folder-add-btn").addEventListener("click",(function(){document.getElementById("folder-dialog").showModal()})),document.getElementById("folder-confirm-btn").addEventListener("click",(function(e){e.preventDefault();const t=document.getElementById("folder-dialog"),{folderTitleInForm:n}=function(){const e=document.getElementById("folder-form");return{folderForm:e,folderTitleInForm:e.elements["folder-title"].value}}();let o=s(n);u(o),m.addFolder(o),localStorage.setItem("folders",JSON.stringify(m)),h(JSON.parse(localStorage.getItem("folders"))),t.close()})),document.getElementById("task-add-btn").addEventListener("click",(function(e){e.preventDefault();const t=document.getElementById("folder-selection").value,{taskTitle:n,taskDescription:o,taskDueDate:d,taskPriority:r}=function(){const e=document.getElementById("main-form"),t=e.elements["task-title"],n=e.elements["task-description"],o=e.elements["task-due-date"],d=e.elements["task-priority"];return{taskTitle:t.value,taskDescription:n.value,taskDueDate:o.value,taskPriority:d.value}}(),l=a(n,o,d,r);m.folders.forEach((e=>{t===e.myFolderUuid&&e.addTask(l)})),localStorage.setItem("folders",JSON.stringify(m)),h(JSON.parse(localStorage.getItem("folders"))),T(t),document.getElementById("main-form").reset(),f().close()})),document.getElementById("task-edit-btn").addEventListener("click",(function(e){e.preventDefault();const t=document.querySelector(".edit-btn-id"),{taskTitle:n,taskDescription:o,taskDueDate:d,taskPriority:r}=function(){const e=document.getElementById("edit-form"),t=e.elements["task-title"],n=e.elements["task-description"],o=e.elements["task-due-date"],d=e.elements["task-priority"];return{taskTitle:t.value,taskDescription:n.value,taskDueDate:o.value,taskPriority:d.value}}();m.folders.forEach((e=>{e.tasks.forEach((l=>{t.value===l.myTaskUuid&&(l.editTask(n,o,d,r),T(e.myFolderUuid),console.log(l))}))})),t.remove(),p().close()}));const k=a("chores","wash dishes","nov 23","high"),y=a("movies","avatar","nov 29","med"),g=a("coding","todo list","dec 10","low");let E=s("Inbox");E.addTask(k),m.addFolder(E),u(E);let v=s("test2");function h(e){const{mySuperFolderUuid:t}=e;let n=i(t);return e.folders.forEach((e=>{n.addFolder(function(e){const{title:t,myFolderUuid:n}=e;let o=s(t,n);return e.tasks.forEach((e=>{o.addTask(function(e){const{title:t,description:n,dueDate:o,priority:d,myTaskUuid:r}=e;return a(t,n,o,d,r)}(e))})),o}(e))})),n}v.addTask(y),v.addTask(k),v.addTask(g),v.deleteTask(y),m.addFolder(v),u(v),function(){if(localStorage.getItem("folders")){let e=JSON.parse(localStorage.getItem("folders"));h(e).folders.forEach((e=>{u(e)})),h(e)}else localStorage.setItem("folders",JSON.stringify(m))}();let U=i();U.addFolder(v),U.addFolder(E),localStorage.setItem("lsSuperFolder",JSON.stringify(U));let I=h(JSON.parse(localStorage.getItem("lsSuperFolder")));function T(e){m.folders.forEach((t=>{e===t.myFolderUuid&&(document.getElementById("task-container").textContent="",c(t),console.log("match found"))}))}function F(e){m.folders.forEach((t=>{e===t.myFolderUuid&&(console.log(e),m.deleteFolder(t))}))}function S(e){m.folders.forEach((t=>{t.tasks.forEach((n=>{e===n.myTaskUuid&&t.deleteTask(n)}))}))}function C(e){m.folders.forEach((t=>{t.tasks.forEach((t=>{e===t.myTaskUuid&&t.setComplete()}))}))}function b(e){let t;return m.folders.forEach((n=>{n.tasks.forEach((n=>{e===n.myTaskUuid&&(t=n)}))})),t}console.log(I)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TWtCLFNBQVFDLElBQ2IwRyxJQUFXMUcsRUFBS2xDLFlBQ2hCa0MsRUFBSzdCLGFBQ1QsR0FDSCxHQUVULENBRUEsU0FBU2dFLEVBQWVzRSxHQUNwQixJQUFJRSxFQVFKLE9BUEFoRCxFQUFZcEUsUUFBUVEsU0FBUXFELElBQ3hCQSxFQUFPdkUsTUFBTWtCLFNBQVFDLElBQ2J5RyxJQUFhekcsRUFBS2xDLGFBQ2xCNkksRUFBUzNHLEVBQ2IsR0FDSCxJQUVFMkcsQ0FDWCxDQXhEQWxJLFFBQVFDLElBQUk2SCxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9kby1saXN0L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3RvZG8tbGlzdC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0L3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9uYXRpdmUuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9ybmcuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9zdHJpbmdpZnkuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9mYWN0b3JpZXMuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvZG9tLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImNvbnN0IHJhbmRvbVVVSUQgPSB0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8ucmFuZG9tVVVJRCAmJiBjcnlwdG8ucmFuZG9tVVVJRC5iaW5kKGNyeXB0byk7XG5leHBvcnQgZGVmYXVsdCB7XG4gIHJhbmRvbVVVSURcbn07IiwiLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gSW4gdGhlIGJyb3dzZXIgd2UgdGhlcmVmb3JlXG4vLyByZXF1aXJlIHRoZSBjcnlwdG8gQVBJIGFuZCBkbyBub3Qgc3VwcG9ydCBidWlsdC1pbiBmYWxsYmFjayB0byBsb3dlciBxdWFsaXR5IHJhbmRvbSBudW1iZXJcbi8vIGdlbmVyYXRvcnMgKGxpa2UgTWF0aC5yYW5kb20oKSkuXG5sZXQgZ2V0UmFuZG9tVmFsdWVzO1xuY29uc3Qgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBybmcoKSB7XG4gIC8vIGxhenkgbG9hZCBzbyB0aGF0IGVudmlyb25tZW50cyB0aGF0IG5lZWQgdG8gcG9seWZpbGwgaGF2ZSBhIGNoYW5jZSB0byBkbyBzb1xuICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgIC8vIGdldFJhbmRvbVZhbHVlcyBuZWVkcyB0byBiZSBpbnZva2VkIGluIGEgY29udGV4dCB3aGVyZSBcInRoaXNcIiBpcyBhIENyeXB0byBpbXBsZW1lbnRhdGlvbi5cbiAgICBnZXRSYW5kb21WYWx1ZXMgPSB0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChjcnlwdG8pO1xuXG4gICAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY3J5cHRvLmdldFJhbmRvbVZhbHVlcygpIG5vdCBzdXBwb3J0ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQjZ2V0cmFuZG9tdmFsdWVzLW5vdC1zdXBwb3J0ZWQnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbn0iLCJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG4vKipcbiAqIENvbnZlcnQgYXJyYXkgb2YgMTYgYnl0ZSB2YWx1ZXMgdG8gVVVJRCBzdHJpbmcgZm9ybWF0IG9mIHRoZSBmb3JtOlxuICogWFhYWFhYWFgtWFhYWC1YWFhYLVhYWFgtWFhYWFhYWFhYWFhYXG4gKi9cblxuY29uc3QgYnl0ZVRvSGV4ID0gW107XG5cbmZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgYnl0ZVRvSGV4LnB1c2goKGkgKyAweDEwMCkudG9TdHJpbmcoMTYpLnNsaWNlKDEpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuc2FmZVN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgLy8gTm90ZTogQmUgY2FyZWZ1bCBlZGl0aW5nIHRoaXMgY29kZSEgIEl0J3MgYmVlbiB0dW5lZCBmb3IgcGVyZm9ybWFuY2VcbiAgLy8gYW5kIHdvcmtzIGluIHdheXMgeW91IG1heSBub3QgZXhwZWN0LiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkL3B1bGwvNDM0XG4gIHJldHVybiBieXRlVG9IZXhbYXJyW29mZnNldCArIDBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDNdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA1XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDZdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgN11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA4XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDldXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTNdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTVdXTtcbn1cblxuZnVuY3Rpb24gc3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICBjb25zdCB1dWlkID0gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0KTsgLy8gQ29uc2lzdGVuY3kgY2hlY2sgZm9yIHZhbGlkIFVVSUQuICBJZiB0aGlzIHRocm93cywgaXQncyBsaWtlbHkgZHVlIHRvIG9uZVxuICAvLyBvZiB0aGUgZm9sbG93aW5nOlxuICAvLyAtIE9uZSBvciBtb3JlIGlucHV0IGFycmF5IHZhbHVlcyBkb24ndCBtYXAgdG8gYSBoZXggb2N0ZXQgKGxlYWRpbmcgdG9cbiAgLy8gXCJ1bmRlZmluZWRcIiBpbiB0aGUgdXVpZClcbiAgLy8gLSBJbnZhbGlkIGlucHV0IHZhbHVlcyBmb3IgdGhlIFJGQyBgdmVyc2lvbmAgb3IgYHZhcmlhbnRgIGZpZWxkc1xuXG4gIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ1N0cmluZ2lmaWVkIFVVSUQgaXMgaW52YWxpZCcpO1xuICB9XG5cbiAgcmV0dXJuIHV1aWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHN0cmluZ2lmeTsiLCJpbXBvcnQgbmF0aXZlIGZyb20gJy4vbmF0aXZlLmpzJztcbmltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IHsgdW5zYWZlU3RyaW5naWZ5IH0gZnJvbSAnLi9zdHJpbmdpZnkuanMnO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBpZiAobmF0aXZlLnJhbmRvbVVVSUQgJiYgIWJ1ZiAmJiAhb3B0aW9ucykge1xuICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICB9XG5cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gdW5zYWZlU3RyaW5naWZ5KHJuZHMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2NDsiLCJpbXBvcnQge3Y0IGFzIHV1aWR2NH0gZnJvbSAndXVpZCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBUYXNrKHRpdGxlLCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSwgcHJpb3JpdHksIG15VGFza1V1aWQgPSB1dWlkdjQoKSkge1xuXG4gICAgLy8gbGV0IG15VGFza1V1aWQgPSB1dWlkdjQoKTtcblxuICAgIGxldCBjb21wbGV0ZVN0YXRlID0gZmFsc2U7XG5cbiAgICBjb25zdCBnZXRDb21wbGV0ZVN0YXRlID0gKCkgPT4gY29tcGxldGVTdGF0ZTtcblxuICAgIGNvbnN0IHNldENvbXBsZXRlID0gKCkgPT4ge1xuICAgICAgICBpZiAoZ2V0Q29tcGxldGVTdGF0ZSgpID09IGZhbHNlKSB7XG4gICAgICAgICAgICBjb21wbGV0ZVN0YXRlID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbXBsZXRlU3RhdGUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9XG4gICAgdGl0bGUgPSB0aXRsZS50b1N0cmluZygpO1xuICAgIGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24udG9TdHJpbmcoKTtcblxuICAgIGNvbnN0IGNoYW5nZVByaW9yaXR5ID0gKG5ld1ByaW9yaXR5KSA9PiB7XG4gICAgICAgIHByaW9yaXR5ID0gbmV3UHJpb3JpdHk7XG4gICAgfVxuXG4gICAgY29uc3QgZWRpdFRhc2sgPSAobmV3VGl0bGUsIG5ld0Rlc2NyaXB0aW9uLCBuZXdEdWVEYXRlLCBuZXdQcmlvcml0eSkgPT4ge1xuICAgICAgICB0aXRsZSA9IG5ld1RpdGxlO1xuICAgICAgICBkZXNjcmlwdGlvbiA9IG5ld0Rlc2NyaXB0aW9uO1xuICAgICAgICBkdWVEYXRlID0gbmV3RHVlRGF0ZTtcbiAgICAgICAgY2hhbmdlUHJpb3JpdHkobmV3UHJpb3JpdHkpO1xuICAgIH1cblxuICAgIGNvbnN0IHByaW50VGFzayA9ICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYFRhc2sgdGl0bGUgLSAke3RpdGxlfSwgRGVzYyAtICR7ZGVzY3JpcHRpb259LCBEYXRlIC0gJHtkdWVEYXRlfSwgUHJpb3JpdHkgLSAke3ByaW9yaXR5fWApO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGdldCB0aXRsZSgpIHtyZXR1cm4gdGl0bGV9LCBcbiAgICAgICAgZ2V0IGRlc2NyaXB0aW9uKCkge3JldHVybiBkZXNjcmlwdGlvbn0sIFxuICAgICAgICBnZXQgZHVlRGF0ZSgpIHtyZXR1cm4gZHVlRGF0ZX0sIFxuICAgICAgICBnZXQgcHJpb3JpdHkoKSB7cmV0dXJuIHByaW9yaXR5fSxcbiAgICAgICAgZ2V0Q29tcGxldGVTdGF0ZSxcbiAgICAgICAgc2V0Q29tcGxldGUsIFxuICAgICAgICBjaGFuZ2VQcmlvcml0eSxcbiAgICAgICAgZWRpdFRhc2ssXG4gICAgICAgIHByaW50VGFzayxcbiAgICAgICAgbXlUYXNrVXVpZFxuICAgIH07XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gRm9sZGVyKHRpdGxlLCBteUZvbGRlclV1aWQ9dXVpZHY0KCkpIHtcbiAgICBcblxuICAgIC8vIGxldCBteUZvbGRlclV1aWQgPSB1dWlkdjQoKTtcbiAgICBsZXQgdGFza3MgPSBbXTtcblxuICAgIGNvbnN0IGFkZFRhc2sgPSAobmV3VGFza05hbWUpID0+IHtcbiAgICAgICAgdGFza3MucHVzaChuZXdUYXNrTmFtZSk7XG5cblxuICAgICAgICAvLyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShuZXdUYXNrTmFtZS5teVRhc2tVdWlkLCBKU09OLnN0cmluZ2lmeShuZXdUYXNrTmFtZSkpO1xuICAgIH1cblxuICAgIGNvbnN0IGRpc3BsYXlUYXNrcyA9ICgpID0+IHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YXNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFRhc2sgJHtpfSAtICR7dGFza3NbaV0udGl0bGV9LCAke3Rhc2tzW2ldLmR1ZURhdGV9LCAke3Rhc2tzW2ldLnByaW9yaXR5fWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgZGVsZXRlVGFzayA9ICh0YXNrTmFtZSkgPT4ge1xuICAgICAgICAvLyB0YXNrcy5zcGxpY2UodGFza05hbWUsIDEpO1xuICAgICAgICBmb3IgKGxldCBpID0gdGFza3MubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgICAgIGlmICh0YXNrc1tpXS5teVRhc2tVdWlkID09PSB0YXNrTmFtZS5teVRhc2tVdWlkKSB7XG4gICAgICAgICAgICAgICAgdGFza3Muc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7dGl0bGUsIHRhc2tzLCBteUZvbGRlclV1aWQsIGFkZFRhc2ssIGRpc3BsYXlUYXNrcywgZGVsZXRlVGFza307XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBTdXBlckZvbGRlcihteVN1cGVyRm9sZGVyVXVpZD11dWlkdjQoKSkge1xuICAgIGxldCBmb2xkZXJzID0gW11cblxuICAgIGNvbnN0IGFkZEZvbGRlciA9IChuZXdGb2xkZXJOYW1lKSA9PiB7XG4gICAgICAgIGZvbGRlcnMucHVzaChuZXdGb2xkZXJOYW1lKTtcblxuICAgICAgICAvLyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShuZXdGb2xkZXJOYW1lLm15Rm9sZGVyVXVpZCwgSlNPTi5zdHJpbmdpZnkobmV3Rm9sZGVyTmFtZSkpO1xuICAgIH1cblxuICAgIGNvbnN0IGRlbGV0ZUZvbGRlciA9IChmb2xkZXJOYW1lKSA9PiB7XG4gICAgICAgIGZvciAobGV0IGkgPSBmb2xkZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgICAgICBpZiAoZm9sZGVyc1tpXS5teUZvbGRlclV1aWQgPT09IGZvbGRlck5hbWUubXlGb2xkZXJVdWlkKSB7XG4gICAgICAgICAgICAgICAgZm9sZGVycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShmb2xkZXJOYW1lLm15Rm9sZGVyVXVpZCk7XG5cbiAgICB9XG5cbiAgICByZXR1cm4ge2ZvbGRlcnMsIGFkZEZvbGRlciwgZGVsZXRlRm9sZGVyLCBteVN1cGVyRm9sZGVyVXVpZH1cbn0iLCJpbXBvcnQge1xuICAgIGRpc3BsYXlDdXJyZW50Rm9sZGVyV2l0aElkLFxuICAgIGRlbGV0ZUZvbGRlcldpdGhJZCxcbiAgICBkZWxldGVUYXNrV2l0aElkLFxuICAgIGNoYW5nZVRhc2tTdGF0dXMsXG4gICAgZmluZFRhc2tXaXRoSWQsXG4gICAgZ2V0RWRpdERpYWxvZ1xufSBmcm9tICcuLi9pbmRleC5qcyc7XG5cblxuLy8gQ3JlYXRlIGFsbCBlbGVtZW50cyBmb3IgZWFjaCB0YXNrIHByb3BlcnR5IGFuZCBjaGFuZ2UgdGV4dCBjb250ZW50IHRvIGNvcnJlc3BvbmRpbmcgdmFsdWVcbi8vIFRoZW4gYWRkIHRoZW0gdG8gYSBtYWluIGRpdiBhbmQgcmV0dXJuXG5mdW5jdGlvbiBjcmVhdGVUYXNrRWxlbWVudCh0YXNrTmFtZSkge1xuICAgIGNvbnN0IHRhc2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCB0YXNrVGl0bGVJbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBjb25zdCB0YXNrRGVzY3JpcHRpb25JbkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBjb25zdCB0YXNrRHVlRGF0ZUluRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgIGNvbnN0IHRhc2tQcmlvcml0eUluRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgIFxuICAgIHRhc2tEaXYuY2xhc3NMaXN0LmFkZCgndGFzay1kaXYnKTtcbiAgICB0YXNrVGl0bGVJbkRpdi50ZXh0Q29udGVudCA9IHRhc2tOYW1lLnRpdGxlO1xuICAgIHRhc2tEZXNjcmlwdGlvbkluRGl2LnRleHRDb250ZW50ID0gdGFza05hbWUuZGVzY3JpcHRpb247XG4gICAgdGFza0R1ZURhdGVJbkRpdi50ZXh0Q29udGVudCA9IHRhc2tOYW1lLmR1ZURhdGU7XG4gICAgdGFza1ByaW9yaXR5SW5EaXYudGV4dENvbnRlbnQgPSB0YXNrTmFtZS5wcmlvcml0eTtcblxuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza1RpdGxlSW5EaXYpO1xuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza0Rlc2NyaXB0aW9uSW5EaXYpO1xuICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQodGFza0R1ZURhdGVJbkRpdik7XG4gICAgdGFza0Rpdi5hcHBlbmRDaGlsZCh0YXNrUHJpb3JpdHlJbkRpdik7XG4gICAgY3JlYXRlVGFza0RlbGV0ZUJ1dHRvbih0YXNrRGl2KS52YWx1ZSA9IHRhc2tOYW1lLm15VGFza1V1aWQ7XG4gICAgY3JlYXRlVGFza0VkaXRCdXR0b24odGFza0RpdikudmFsdWUgPSB0YXNrTmFtZS5teVRhc2tVdWlkO1xuICAgIGNyZWF0ZVRhc2tTdGF0dXNCdXR0b24odGFza0RpdikudmFsdWUgPSB0YXNrTmFtZS5teVRhc2tVdWlkO1xuXG4gICAgcmV0dXJuIHRhc2tEaXY7XG59XG5cbi8vIFRha2UgaW4gdGFzayBhbmQgd2hlcmUgdG8gYXBwZW5kXG4vLyBDcmVhdGUgdGhlIHRhc2sgdXNpbmcgY3JlYXRlVGFza0VsZW1lbnQgYW5kIGFzc2lnbiB0byB2YXJpYWJsZVxuLy8gVGFyZ2V0IGVsZW1lbnQgdG8gYXBwZW5kIHRvIGFuZCBhcHBlbmRcbmZ1bmN0aW9uIGFwcGVuZFRhc2sodGFza05hbWUsIGxvY2F0aW9uKSB7XG4gICAgbGV0IHRhc2tET00gPSBjcmVhdGVUYXNrRWxlbWVudCh0YXNrTmFtZSk7XG5cbiAgICBjb25zdCBsb2NhdGlvbkRPTSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGxvY2F0aW9uKTtcbiAgICBsb2NhdGlvbkRPTS5hcHBlbmRDaGlsZCh0YXNrRE9NKTtcbn1cblxuLy8gVGFrZSBpbiBmb2xkZXIgbmFtZSB0aGVuIGxvb3AgdGhyb3VnaCB0YXNrcyBpbnNpZGUgZm9sZGVyIHRvIGFwcGVuZCB0byBzY3JlZW5cbmZ1bmN0aW9uIGRpc3BsYXlGb2xkZXJUYXNrcyhmb2xkZXJOYW1lKSB7XG4gICAgZm9sZGVyTmFtZS50YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICBhcHBlbmRUYXNrKHRhc2ssIFsndGFzay1jb250YWluZXInXSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldFRhc2tGb3JtSW5mbygpIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4tZm9ybScpO1xuXG4gICAgY29uc3QgdGFza1RpdGxlSW5Gb3JtID0gZm9ybS5lbGVtZW50c1sndGFzay10aXRsZSddO1xuICAgIGNvbnN0IHRhc2tEZXNjcmlwdGlvbkluRm9ybSA9IGZvcm0uZWxlbWVudHNbJ3Rhc2stZGVzY3JpcHRpb24nXTtcbiAgICBjb25zdCB0YXNrRHVlRGF0ZUluRm9ybSA9IGZvcm0uZWxlbWVudHNbJ3Rhc2stZHVlLWRhdGUnXTtcbiAgICBjb25zdCB0YXNrUHJpb3JpdHlJbkZvcm0gPSBmb3JtLmVsZW1lbnRzWyd0YXNrLXByaW9yaXR5J107XG4gICAgXG4gICAgbGV0IHRhc2tUaXRsZSA9IHRhc2tUaXRsZUluRm9ybS52YWx1ZTtcbiAgICBsZXQgdGFza0Rlc2NyaXB0aW9uID0gdGFza0Rlc2NyaXB0aW9uSW5Gb3JtLnZhbHVlO1xuICAgIGxldCB0YXNrRHVlRGF0ZSA9IHRhc2tEdWVEYXRlSW5Gb3JtLnZhbHVlO1xuICAgIGxldCB0YXNrUHJpb3JpdHkgPSB0YXNrUHJpb3JpdHlJbkZvcm0udmFsdWU7XG5cbiAgICByZXR1cm4ge3Rhc2tUaXRsZSwgdGFza0Rlc2NyaXB0aW9uLCB0YXNrRHVlRGF0ZSwgdGFza1ByaW9yaXR5fTtcbn0gXG5cbmZ1bmN0aW9uIGdldFRhc2tFZGl0Rm9ybUluZm8oKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LWZvcm0nKTtcblxuICAgIGNvbnN0IHRhc2tUaXRsZUluRm9ybSA9IGZvcm0uZWxlbWVudHNbJ3Rhc2stdGl0bGUnXTtcbiAgICBjb25zdCB0YXNrRGVzY3JpcHRpb25JbkZvcm0gPSBmb3JtLmVsZW1lbnRzWyd0YXNrLWRlc2NyaXB0aW9uJ107XG4gICAgY29uc3QgdGFza0R1ZURhdGVJbkZvcm0gPSBmb3JtLmVsZW1lbnRzWyd0YXNrLWR1ZS1kYXRlJ107XG4gICAgY29uc3QgdGFza1ByaW9yaXR5SW5Gb3JtID0gZm9ybS5lbGVtZW50c1sndGFzay1wcmlvcml0eSddO1xuICAgIFxuICAgIGxldCB0YXNrVGl0bGUgPSB0YXNrVGl0bGVJbkZvcm0udmFsdWU7XG4gICAgbGV0IHRhc2tEZXNjcmlwdGlvbiA9IHRhc2tEZXNjcmlwdGlvbkluRm9ybS52YWx1ZTtcbiAgICBsZXQgdGFza0R1ZURhdGUgPSB0YXNrRHVlRGF0ZUluRm9ybS52YWx1ZTtcbiAgICBsZXQgdGFza1ByaW9yaXR5ID0gdGFza1ByaW9yaXR5SW5Gb3JtLnZhbHVlO1xuXG4gICAgcmV0dXJuIHt0YXNrVGl0bGUsIHRhc2tEZXNjcmlwdGlvbiwgdGFza0R1ZURhdGUsIHRhc2tQcmlvcml0eX07XG59IFxuXG4vLyBDcmVhdGUgYnV0dG9uIHRvIGhvbGQgZm9sZGVyIGFuZCB0aXRsZVxuLy8gQWRkIHRpdGxlIHRvIGRpdiBhbmQgcmV0dXJuXG5mdW5jdGlvbiBjcmVhdGVGb2xkZXJCdXR0b24oZm9sZGVyTmFtZSkge1xuICAgIGNvbnN0IHNpZGViYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2lkZWJhcicpO1xuICAgIGNvbnN0IGZvbGRlckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IGZvbGRlckJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuXG4gICAgZm9sZGVyRGl2LmNsYXNzTGlzdC5hZGQoJ2ZvbGRlci1kaXYnKTtcbiAgICBmb2xkZXJCdG4uY2xhc3NMaXN0LmFkZCgnZm9sZGVyLWJ1dHRvbicpO1xuICAgIGZvbGRlckJ0bi50ZXh0Q29udGVudCA9IGZvbGRlck5hbWUudGl0bGU7XG4gICAgZm9sZGVyQnRuLnZhbHVlID0gZm9sZGVyTmFtZS5teUZvbGRlclV1aWQ7XG5cbiAgICBmb2xkZXJEaXYuYXBwZW5kQ2hpbGQoZm9sZGVyQnRuKTtcbiAgICBcbiAgICAvLyBDcmVhdGUgdGhlIGRlbCBidG4gYW5kICBhc3NpZ24gc2FtZSBpZCBhcyBmb2xkZXIgdG8gaXRcbiAgICBjcmVhdGVGb2xkZXJEZWxldGVCdXR0b24oZm9sZGVyRGl2KS52YWx1ZSA9IGZvbGRlck5hbWUubXlGb2xkZXJVdWlkO1xuXG4gICAgc2lkZWJhci5hcHBlbmRDaGlsZChmb2xkZXJEaXYpO1xuXG4gICAgZm9sZGVyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBjdXJyZW50Rm9sZGVySWQgPSBmb2xkZXJOYW1lLm15Rm9sZGVyVXVpZDtcbiAgICAgICAgZGlzcGxheUN1cnJlbnRGb2xkZXJXaXRoSWQoZm9sZGVyTmFtZS5teUZvbGRlclV1aWQpO1xuICAgICAgICBjb25zb2xlLmxvZyhmb2xkZXJOYW1lLnRpdGxlLCBmb2xkZXJOYW1lLm15Rm9sZGVyVXVpZCk7XG4gICAgICAgIHJldHVybiBjdXJyZW50Rm9sZGVySWQ7XG4gICAgfSk7XG4gICAgXG4gICAgcmV0dXJuIGZvbGRlckRpdjtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRm9sZGVyRGVsZXRlQnV0dG9uKGZvbGRlcikge1xuICAgIGNvbnN0IGZvbGRlckRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuXG4gICAgZm9sZGVyRGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoJ2ZvbGRlci1kZWxldGUtYnRuJyk7XG4gICAgZm9sZGVyRGVsZXRlQnRuLnRleHRDb250ZW50ID0gJy0nO1xuXG4gICAgZm9sZGVyLmFwcGVuZENoaWxkKGZvbGRlckRlbGV0ZUJ0bik7XG5cbiAgICBmb2xkZXJEZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGxldCB0aGlzQnV0dG9uID0gZS50YXJnZXQ7XG4gICAgICAgIGRlbGV0ZUZvbGRlcldpdGhJZCh0aGlzQnV0dG9uLnZhbHVlKTtcbiAgICAgICAgdGhpc0J1dHRvbi5wYXJlbnROb2RlLnJlbW92ZSgpO1xuICAgIH0pXG5cbiAgICByZXR1cm4gZm9sZGVyRGVsZXRlQnRuO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUYXNrRGVsZXRlQnV0dG9uKHRhc2spIHtcbiAgICBjb25zdCB0YXNrRGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cbiAgICB0YXNrRGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoJ3Rhc2stZGVsZXRlLWJ0bicpO1xuICAgIHRhc2tEZWxldGVCdG4udGV4dENvbnRlbnQgPSAnLSc7XG5cbiAgICB0YXNrLmFwcGVuZENoaWxkKHRhc2tEZWxldGVCdG4pO1xuXG4gICAgdGFza0RlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgbGV0IHRoaXNCdXR0b24gPSBlLnRhcmdldDtcbiAgICAgICAgZGVsZXRlVGFza1dpdGhJZCh0aGlzQnV0dG9uLnZhbHVlKTtcbiAgICAgICAgdGhpc0J1dHRvbi5wYXJlbnROb2RlLnJlbW92ZSgpO1xuICAgIH0pXG5cbiAgICByZXR1cm4gdGFza0RlbGV0ZUJ0bjtcbn1cblxuZnVuY3Rpb24gY3JlYXRlVGFza0VkaXRCdXR0b24odGFzaykge1xuICAgIGNvbnN0IHRhc2tFZGl0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cbiAgICB0YXNrRWRpdEJ0bi5jbGFzc0xpc3QuYWRkKCd0YXNrLWVkaXQtYnRuJyk7XG4gICAgdGFza0VkaXRCdG4udGV4dENvbnRlbnQgPSAnKyc7XG5cbiAgICB0YXNrLmFwcGVuZENoaWxkKHRhc2tFZGl0QnRuKTtcblxuICAgIHRhc2tFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAvLyBDcmVhdGUgYSBidXR0b24gdG8gaG9sZCBJZCB2YWx1ZVxuICAgICAgICBjb25zdCBlZGl0Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LWZvcm0nKTtcbiAgICAgICAgY29uc3QgYnRuRm9ySWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcblxuICAgICAgICBidG5Gb3JJZC5jbGFzc0xpc3QuYWRkKCdlZGl0LWJ0bi1pZCcpO1xuICAgICAgICBidG5Gb3JJZC52YWx1ZSA9IGUudGFyZ2V0LnZhbHVlXG4gICAgICAgIGVkaXRGb3JtLmFwcGVuZENoaWxkKGJ0bkZvcklkKTtcblxuICAgICAgICAvLyBDaGFuZ2UgZm9ybSBmaWVsZHMgdG8gdGFzayBpbmZvIGFuZCBvcGVuIG1vZGFsXG4gICAgICAgIGNoYW5nZVRhc2tGb3JtRmllbGRzKGZpbmRUYXNrV2l0aElkKGUudGFyZ2V0LnZhbHVlKSk7XG4gICAgICAgIGdldEVkaXREaWFsb2coKS5zaG93TW9kYWwoKTtcbiAgICB9KVxuXG4gICAgcmV0dXJuIHRhc2tFZGl0QnRuO1xufVxuXG5mdW5jdGlvbiBjaGFuZ2VUYXNrRm9ybUZpZWxkcyh0YXNrKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LWZvcm0nKTtcblxuICAgIGNvbnN0IHRhc2tUaXRsZUluRm9ybSA9IGZvcm0uZWxlbWVudHNbJ3Rhc2stdGl0bGUnXTtcbiAgICBjb25zdCB0YXNrRGVzY3JpcHRpb25JbkZvcm0gPSBmb3JtLmVsZW1lbnRzWyd0YXNrLWRlc2NyaXB0aW9uJ107XG4gICAgY29uc3QgdGFza0R1ZURhdGVJbkZvcm0gPSBmb3JtLmVsZW1lbnRzWyd0YXNrLWR1ZS1kYXRlJ107XG4gICAgY29uc3QgdGFza1ByaW9yaXR5SW5Gb3JtID0gZm9ybS5lbGVtZW50c1sndGFzay1wcmlvcml0eSddO1xuXG4gICAgdGFza1RpdGxlSW5Gb3JtLnZhbHVlID0gdGFzay50aXRsZTtcbiAgICB0YXNrRGVzY3JpcHRpb25JbkZvcm0udmFsdWUgPSB0YXNrLmRlc2NyaXB0aW9uO1xuICAgIHRhc2tEdWVEYXRlSW5Gb3JtLnZhbHVlID0gdGFzay5kdWVEYXRlO1xuICAgIHRhc2tQcmlvcml0eUluRm9ybS52YWx1ZSA9IHRhc2sucHJpb3JpdHk7XG59IFxuXG5mdW5jdGlvbiBjcmVhdGVUYXNrU3RhdHVzQnV0dG9uKHRhc2spIHtcbiAgICBjb25zdCB0YXNrU3RhdHVzQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cbiAgICB0YXNrU3RhdHVzQnRuLmNsYXNzTGlzdC5hZGQoJ3Rhc2stc3RhdHVzLWJ0bicpO1xuICAgIHRhc2tTdGF0dXNCdG4udGV4dENvbnRlbnQgPSAn4pyUJztcblxuICAgIHRhc2suYXBwZW5kQ2hpbGQodGFza1N0YXR1c0J0bik7XG5cbiAgICB0YXNrU3RhdHVzQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICBsZXQgdGhpc0J1dHRvbiA9IGUudGFyZ2V0O1xuICAgICAgICBjaGFuZ2VUYXNrU3RhdHVzKHRoaXNCdXR0b24udmFsdWUpO1xuICAgICAgICB0b2dnbGVDb21wbGV0ZVN0eWxlKHRoaXNCdXR0b24pO1xuICAgIH0pXG5cbiAgICByZXR1cm4gdGFza1N0YXR1c0J0bjtcbn1cblxuZnVuY3Rpb24gdG9nZ2xlQ29tcGxldGVTdHlsZShlbGVtZW50KSB7XG4gICAgaWYgKCFlbGVtZW50LnBhcmVudE5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb21wbGV0ZS10YXNrJykpIHtcbiAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2NvbXBsZXRlLXRhc2snKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjb21wbGV0ZS10YXNrJyk7XG4gICAgfVxufVxuXG4vLyBUYWtlIGluIGZvbGRlciBuYW1lIGFuZCBjcmVhdGUgZm9sZGVyIHVzaW5nIGZ1bmN0aW9uXG4vLyBBcHBlbmQgdG8gc2lkZWJhclxuZnVuY3Rpb24gYXBwZW5kRm9sZGVyKGZvbGRlck5hbWUpIHtcbiAgICBsZXQgZm9sZGVyRE9NID0gY3JlYXRlRm9sZGVyQnV0dG9uKGZvbGRlck5hbWUpO1xuICAgIFxuICAgIGNvbnN0IHNpZGViYXJGb2xkZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNpZGViYXInKTtcbiAgICBzaWRlYmFyRm9sZGVycy5hcHBlbmRDaGlsZChmb2xkZXJET00pO1xufVxuXG4vLyBUYWtlIGluIHN1cGVyIGZvbGRlciBuYW1lIHRvIGxvb3AgdGhyb3VnaCBlYWNoIGZvbGRlciBhbmQgYXBwZW5kIHRvIHNpZGViYXJcbmZ1bmN0aW9uIGRpc3BsYXlGb2xkZXJzKHN1cGVyRm9sZGVyTmFtZSkge1xuICAgIC8vIGNsZWFyU2lkZWJhcigpO1xuICAgIHN1cGVyRm9sZGVyTmFtZS5mb2xkZXJzLmZvckVhY2goZm9sZGVyID0+IHtcbiAgICAgICAgYXBwZW5kRm9sZGVyKGZvbGRlcik7XG4gICAgfSk7XG59XG5cblxuZnVuY3Rpb24gZ2V0Rm9sZGVyRm9ybUluZm8oKSB7XG4gICAgY29uc3QgZm9sZGVyRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXItZm9ybScpO1xuXG4gICAgY29uc3QgZm9sZGVyVGl0bGVJbkZvcm0gPSBmb2xkZXJGb3JtLmVsZW1lbnRzWydmb2xkZXItdGl0bGUnXS52YWx1ZTtcblxuICAgIHJldHVybiB7Zm9sZGVyRm9ybSwgZm9sZGVyVGl0bGVJbkZvcm19O1xufVxuXG5mdW5jdGlvbiBjbGVhclRhc2tDb250YWluZXIoKSB7XG4gICAgY29uc3QgdGFza0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrLWNvbnRhaW5lcicpO1xuXG4gICAgdGFza0NvbnRhaW5lci50ZXh0Q29udGVudCA9ICcnO1xufVxuXG5mdW5jdGlvbiBhcHBlbmREcm9wZG93bihzdXBlckZvbGRlcikge1xuXG4gICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRlci1zZWxlY3Rpb24nKTtcblxuICAgIGNsZWFyU2VsZWN0TWVudShzZWxlY3QpO1xuXG4gICAgc3VwZXJGb2xkZXIuZm9sZGVycy5mb3JFYWNoKGZvbGRlciA9PiB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgICBcbiAgICAgICAgb3B0aW9uLnRleHRDb250ZW50ID0gZm9sZGVyLnRpdGxlO1xuICAgICAgICBvcHRpb24udmFsdWUgPSBmb2xkZXIubXlGb2xkZXJVdWlkOyAvLyBmaWd1cmUgb3V0IGlmIHRoaXMgaXMgZ29vZCB3YXkgdG8gc2VsZWN0XG4gICAgICAgIC8vIG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ2luZGV4JywgaW5kZXgrKyk7XG5cbiAgICAgICAgc2VsZWN0LmFwcGVuZENoaWxkKG9wdGlvbik7XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gY2xlYXJTZWxlY3RNZW51KHNlbGVjdE9wdGlvbikge1xuICAgIGZvciAobGV0IGkgPSBzZWxlY3RPcHRpb24ub3B0aW9ucy5sZW5ndGg7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIHNlbGVjdE9wdGlvbi5yZW1vdmUoMCk7XG4gICAgfVxufVxuXG5leHBvcnQge1xuICAgIGdldFRhc2tGb3JtSW5mbyxcbiAgICBnZXRUYXNrRWRpdEZvcm1JbmZvLFxuICAgIGdldEZvbGRlckZvcm1JbmZvLFxuICAgIGNyZWF0ZVRhc2tFbGVtZW50LFxuICAgIGNyZWF0ZUZvbGRlckJ1dHRvbixcbiAgICBhcHBlbmRGb2xkZXIsXG4gICAgZGlzcGxheUZvbGRlclRhc2tzLFxuICAgIGFwcGVuZFRhc2ssXG4gICAgZGlzcGxheUZvbGRlcnMsXG4gICAgY2xlYXJUYXNrQ29udGFpbmVyLFxuICAgIGFwcGVuZERyb3Bkb3duLFxuICAgIGNsZWFyU2VsZWN0TWVudSxcbn0iLCJpbXBvcnQge1xuICAgIFRhc2ssXG4gICAgRm9sZGVyLFxuICAgIFN1cGVyRm9sZGVyXG59IGZyb20gJy4vbW9kdWxlcy9mYWN0b3JpZXMuanMnO1xuXG5pbXBvcnQge1xuICAgIGdldFRhc2tGb3JtSW5mbyxcbiAgICBnZXRUYXNrRWRpdEZvcm1JbmZvLFxuICAgIGdldEZvbGRlckZvcm1JbmZvLFxuICAgIGFwcGVuZEZvbGRlcixcbiAgICBkaXNwbGF5Rm9sZGVyVGFza3MsXG4gICAgY2xlYXJUYXNrQ29udGFpbmVyLFxuICAgIGFwcGVuZERyb3Bkb3duLFxuICAgIGRpc3BsYXlGb2xkZXJzXG5cbn0gZnJvbSAnLi9tb2R1bGVzL2RvbS5qcyc7XG5cbmltcG9ydCB7IGZvcm1hdERpc3RhbmNlLCBzdWJEYXlzIH0gZnJvbSBcImRhdGUtZm5zXCI7XG5cblxuLy9TdXBlciBGb2xkZXIgXG5jb25zdCBzdXBlckZvbGRlciA9IFN1cGVyRm9sZGVyKCk7XG5cbi8vIE9wZW4gdGFzayBtb2RhbCB3aGVuIGNsaWNrZWRcbmNvbnN0IG9wZW5UYXNrTW9kYWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3Blbi10YXNrLW1vZGFsLWJ0bicpO1xub3BlblRhc2tNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgIGdldFRhc2tEaWFsb2coKS5yZXNldDtcbiAgICBnZXRUYXNrRGlhbG9nKCkuc2hvd01vZGFsKCk7XG4gICAgYXBwZW5kRHJvcGRvd24oc3VwZXJGb2xkZXIpO1xufSk7XG5cbi8vIEdldCB0YXNrIGRpYWxvZyBhbmQgcmV0dXJuIFxuZnVuY3Rpb24gZ2V0VGFza0RpYWxvZygpIHtcbiAgICBjb25zdCB0YXNrRGlhbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stZGlhbG9nJyk7XG5cbiAgICByZXR1cm4gdGFza0RpYWxvZztcbn1cblxuZnVuY3Rpb24gZ2V0RWRpdERpYWxvZygpIHtcbiAgICBjb25zdCBlZGl0RGlhbG9nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXQtZGlhbG9nJyk7XG5cbiAgICByZXR1cm4gZWRpdERpYWxvZztcbn1cblxuLy8gT3BlbiBmb2xkZXIgbW9kYWwgd2hlbiBjbGlja2VkXG5jb25zdCBhZGRGb2xkZXJCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZGVyLWFkZC1idG4nKTtcbmFkZEZvbGRlckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgIFxuICAgIGNvbnN0IGZvbGRlckRpYWxvZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXItZGlhbG9nJyk7XG4gICAgZm9sZGVyRGlhbG9nLnNob3dNb2RhbCgpO1xuICAgIFxufSk7XG5cbi8vIEV2ZW50IGxpc3RlbmVyIHRvIHN1Ym1pdCBmb2xkZXIgZm9ybVxuLy8gQ3JlYXRlIGEgbmV3IGZvbGRlciBpbnN0YW5jZSB3aXRoIGluZm8gZnJvbSBmb3JtXG4vLyBBZGQgdG8gRE9NXG4vLyBBZGQgdG8gc3VwZXIgZm9sZGVyXG4vLyBTaG91bGQgYmUgZG9uZSBvbiB0aGUgZm9ybSBpbnN0ZWFkIG9mIGJ1dHRvbiBidXQgTUROIGV4YW1wbGUgd2l0aCBkaWFsb2cgZGlkIGl0IHRoaXMgd2F5XG5jb25zdCBmb2xkZXJTdWJtaXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZGVyLWNvbmZpcm0tYnRuJyk7XG5mb2xkZXJTdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIFxuICAgIGNvbnN0IGZvbGRlckRpYWxvZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXItZGlhbG9nJyk7XG4gICAgY29uc3Qge2ZvbGRlclRpdGxlSW5Gb3JtfSA9IGdldEZvbGRlckZvcm1JbmZvKCk7XG5cbiAgICBsZXQgbmV3Rm9sZGVyID0gRm9sZGVyKGZvbGRlclRpdGxlSW5Gb3JtKTtcbiAgICBhcHBlbmRGb2xkZXIobmV3Rm9sZGVyKTtcbiAgICBcbiAgICBzdXBlckZvbGRlci5hZGRGb2xkZXIobmV3Rm9sZGVyKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZm9sZGVycycsIEpTT04uc3RyaW5naWZ5KHN1cGVyRm9sZGVyKSk7XG5cbiAgICBsZXQgc3VwZXJGb2xkZXJGcm9tTHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmb2xkZXJzJykpO1xuXG4gICAgcmVjcmVhdGVTdXBlckZvbGRlckZyb21PYmplY3Qoc3VwZXJGb2xkZXJGcm9tTHMpO1xuXG4gICAgZm9sZGVyRGlhbG9nLmNsb3NlKCk7XG5cbn0pO1xuXG5jb25zdCB0YXNrQWRkQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stYWRkLWJ0bicpO1xuLy8gQ3JlYXRlIG5ldyB0YXNrIGluc3RhbmNlIHVzaW5nIGluZm8gZnJvbSBmb3JtXG50YXNrQWRkQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgIC8vIEdldCB2YWx1ZSBvZiB0aGUgc2VsZWN0ZWQgZmllbGQgKElkIGJlY2F1c2UgdmFsdWUgaXMgc2V0IHRvIGlkIGluIGRvbS5qcylcbiAgICBjb25zdCBzZWxlY3RlZEZvbGRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkZXItc2VsZWN0aW9uJyk7XG4gICAgY29uc3Qgc2VsZWN0ZWRGb2xkZXJWYWx1ZSA9IHNlbGVjdGVkRm9sZGVyLnZhbHVlO1xuICAgIC8vIEdldCB2YWx1ZXMgb2YgdGhlIGZvcm1cbiAgICBjb25zdCB7dGFza1RpdGxlLCB0YXNrRGVzY3JpcHRpb24sIHRhc2tEdWVEYXRlLCB0YXNrUHJpb3JpdHl9ID0gZ2V0VGFza0Zvcm1JbmZvKCk7XG5cbiAgICAvLyBDcmVhdGUgbmV3IHRhc2sgYW5kIGxvb3AgdGhyb3VnaCBmb2xkZXIgdG8gZmluZCBtYXRjaGluZyBJZCBhbmQgYWRkXG4gICAgY29uc3QgbmV3VGFzayA9IFRhc2sodGFza1RpdGxlLCB0YXNrRGVzY3JpcHRpb24sIHRhc2tEdWVEYXRlLCB0YXNrUHJpb3JpdHkpO1xuICAgIHN1cGVyRm9sZGVyLmZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xuICAgICAgICBpZiAoc2VsZWN0ZWRGb2xkZXJWYWx1ZSA9PT0gZm9sZGVyLm15Rm9sZGVyVXVpZCkge1xuICAgICAgICAgICAgZm9sZGVyLmFkZFRhc2sobmV3VGFzayk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdmb2xkZXJzJywgSlNPTi5zdHJpbmdpZnkoc3VwZXJGb2xkZXIpKTtcblxuICAgIGxldCBzdXBlckZvbGRlckZyb21McyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2ZvbGRlcnMnKSk7XG5cbiAgICByZWNyZWF0ZVN1cGVyRm9sZGVyRnJvbU9iamVjdChzdXBlckZvbGRlckZyb21Mcyk7XG5cbiAgICAvLyBVcGRhdGUgdGhlIHRhc2tzIG9mIHRoZSBmb2xkZXIgdGhhdCBpcyBjdXJyZW50bHkgYmVpbmcgZGlzcGxheWVkIHRvIGF2b2lkIHJlbG9hZGluZyBmb2xkZXJcbiAgICBkaXNwbGF5Q3VycmVudEZvbGRlcldpdGhJZChzZWxlY3RlZEZvbGRlclZhbHVlKTtcbiAgICBcbiAgICAvLyBDbGVhciBmb3JtIGZpZWxkc1xuICAgIGNvbnN0IHRhc2tGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4tZm9ybScpO1xuICAgIHRhc2tGb3JtLnJlc2V0KCk7XG4gICAgZ2V0VGFza0RpYWxvZygpLmNsb3NlKCk7XG59KVxuXG4vLyBTZWxlY3QgdGhlIGJ1dHRvbiB3aXRoIElkIGFuZCBmaW5kIHRhc2sgd2l0aCB0aGF0IElkXG4vLyBDaGFuZ2UgdGhlIGluZm8gb2YgdGhhdCB0YXNrIGFuZCB1cGRhdGUgZm9sZGVyXG4vLyBEZWxldGUgYnV0dG9uIGFmdGVyIGFuZCBjbG9zZVxuY29uc3QgdGFza0VkaXRDb25maXJtQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2stZWRpdC1idG4nKTtcbnRhc2tFZGl0Q29uZmlybUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgXG4gICAgY29uc3QgYnRuSWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZWRpdC1idG4taWQnKTtcbiAgICBcbiAgICBjb25zdCB7dGFza1RpdGxlLCB0YXNrRGVzY3JpcHRpb24sIHRhc2tEdWVEYXRlLCB0YXNrUHJpb3JpdHl9ID0gZ2V0VGFza0VkaXRGb3JtSW5mbygpO1xuICAgIFxuICAgIHN1cGVyRm9sZGVyLmZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xuICAgICAgICBmb2xkZXIudGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgICAgIGlmIChidG5JZC52YWx1ZSA9PT0gdGFzay5teVRhc2tVdWlkKSB7XG4gICAgICAgICAgICAgICAgdGFzay5lZGl0VGFzayh0YXNrVGl0bGUsIHRhc2tEZXNjcmlwdGlvbiwgdGFza0R1ZURhdGUsIHRhc2tQcmlvcml0eSk7XG4gICAgICAgICAgICAgICAgZGlzcGxheUN1cnJlbnRGb2xkZXJXaXRoSWQoZm9sZGVyLm15Rm9sZGVyVXVpZCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGFzayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSk7XG4gICAgXG4gICAgYnRuSWQucmVtb3ZlKCk7XG4gICAgZ2V0RWRpdERpYWxvZygpLmNsb3NlKCk7XG4gICAgXG59KVxuXG4vLyBUZXN0IHRhc2tzXG5jb25zdCB0YXNrMSA9IFRhc2soJ2Nob3JlcycsICd3YXNoIGRpc2hlcycsICdub3YgMjMnLCAnaGlnaCcpO1xuY29uc3QgdGFzazIgPSBUYXNrKCdtb3ZpZXMnLCAnYXZhdGFyJywgJ25vdiAyOScsICdtZWQnKTtcbmNvbnN0IHRhc2szID0gVGFzaygnY29kaW5nJywgJ3RvZG8gbGlzdCcsICdkZWMgMTAnLCAnbG93Jyk7XG5cbmxldCBpbmJveEZvbGRlciA9IEZvbGRlcignSW5ib3gnKTtcbmluYm94Rm9sZGVyLmFkZFRhc2sodGFzazEpO1xuc3VwZXJGb2xkZXIuYWRkRm9sZGVyKGluYm94Rm9sZGVyKTtcbmFwcGVuZEZvbGRlcihpbmJveEZvbGRlcik7XG5cbmxldCB0ZXN0Rm9sZGVyMiA9IEZvbGRlcigndGVzdDInKTtcbnRlc3RGb2xkZXIyLmFkZFRhc2sodGFzazIpO1xudGVzdEZvbGRlcjIuYWRkVGFzayh0YXNrMSk7XG50ZXN0Rm9sZGVyMi5hZGRUYXNrKHRhc2szKTtcbnRlc3RGb2xkZXIyLmRlbGV0ZVRhc2sodGFzazIpO1xuc3VwZXJGb2xkZXIuYWRkRm9sZGVyKHRlc3RGb2xkZXIyKTtcbmFwcGVuZEZvbGRlcih0ZXN0Rm9sZGVyMik7XG5cbmZ1bmN0aW9uIGxvYWRQcmVzZXRGb2xkZXJzKCkge1xuICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZm9sZGVycycpKXtcbiAgICAgICAgbGV0IHN1cGVyRm9sZGVyRnJvbUxzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZm9sZGVycycpKTtcblxuICAgICAgICBkaXNwbGF5Rm9sZGVycyhyZWNyZWF0ZVN1cGVyRm9sZGVyRnJvbU9iamVjdChzdXBlckZvbGRlckZyb21McykpO1xuXG4gICAgICAgIHJlY3JlYXRlU3VwZXJGb2xkZXJGcm9tT2JqZWN0KHN1cGVyRm9sZGVyRnJvbUxzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZm9sZGVycycsIEpTT04uc3RyaW5naWZ5KHN1cGVyRm9sZGVyKSk7XG4gICAgfVxufVxuXG5sb2FkUHJlc2V0Rm9sZGVycygpO1xuXG4vLyBSZWNyZWF0ZSB0YXNrIGZyb20gZ2VuZXJlaWMgb2JqZWN0XG5mdW5jdGlvbiByZWNyZWF0ZVRhc2tPYmoodGFyZ2V0T2JqKSB7XG4gICAgY29uc3Qge3RpdGxlLCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSwgcHJpb3JpdHksIG15VGFza1V1aWR9ID0gdGFyZ2V0T2JqO1xuXG4gICAgcmV0dXJuIFRhc2sodGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlLCBwcmlvcml0eSwgbXlUYXNrVXVpZCk7XG59XG5cbi8vIFJlY3JlYXRlIGEgZm9sZGVyIGZyb20gZ2VuZXJpYyBvYmplY3Rcbi8vIExvb3AgdGhyb3VnaCBHRU5FUklDIG9iamVjdHMgdGFza3Ncbi8vIEZvciBlYWNoIHRhc2ssIHJlY3JlYXRlIGEgdGFzayBhbmQgYWRkIHRvIHRoYXQgZm9sZGVyXG5mdW5jdGlvbiByZWNyZWF0ZUZvbGRlckZyb21PYmplY3QoZ2VuZXJpY09iaikge1xuXG4gICAgY29uc3Qge3RpdGxlLCAgbXlGb2xkZXJVdWlkfSA9IGdlbmVyaWNPYmo7XG4gICAgXG4gICAgbGV0IGZvbGRlckR1cGUgPSBGb2xkZXIodGl0bGUsIG15Rm9sZGVyVXVpZCk7XG5cbiAgICBnZW5lcmljT2JqLnRhc2tzLmZvckVhY2godGFzayA9PiB7XG4gICAgICAgIGZvbGRlckR1cGUuYWRkVGFzayhyZWNyZWF0ZVRhc2tPYmoodGFzaykpO1xuICAgIH0pXG5cbiAgICByZXR1cm4gZm9sZGVyRHVwZTtcbiAgICBcbn1cblxuZnVuY3Rpb24gcmVjcmVhdGVTdXBlckZvbGRlckZyb21PYmplY3QoZ2VuZXJpY09iaikge1xuICAgIGNvbnN0IHtteVN1cGVyRm9sZGVyVXVpZH0gPSBnZW5lcmljT2JqO1xuXG4gICAgbGV0IHN1cGVyRm9sZGVyRHVwZSA9IFN1cGVyRm9sZGVyKG15U3VwZXJGb2xkZXJVdWlkKTtcblxuICAgIGdlbmVyaWNPYmouZm9sZGVycy5mb3JFYWNoKGZvbGRlciA9PiB7XG4gICAgICAgIHN1cGVyRm9sZGVyRHVwZS5hZGRGb2xkZXIocmVjcmVhdGVGb2xkZXJGcm9tT2JqZWN0KGZvbGRlcikpXG4gICAgfSlcblxuICAgIHJldHVybiBzdXBlckZvbGRlckR1cGU7XG59XG5cbmxldCBsc1N1cGVyRm9sZGVyID0gU3VwZXJGb2xkZXIoKTtcbmxzU3VwZXJGb2xkZXIuYWRkRm9sZGVyKHRlc3RGb2xkZXIyKTtcbmxzU3VwZXJGb2xkZXIuYWRkRm9sZGVyKGluYm94Rm9sZGVyKTtcbmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdsc1N1cGVyRm9sZGVyJywgSlNPTi5zdHJpbmdpZnkobHNTdXBlckZvbGRlcikpO1xuXG5sZXQgZ2VuZXJpY1N1cGVyRm9sZGVyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbHNTdXBlckZvbGRlcicpKTtcblxubGV0IG5ld0xzU3VwZXJGb2xkZXIgPSByZWNyZWF0ZVN1cGVyRm9sZGVyRnJvbU9iamVjdChnZW5lcmljU3VwZXJGb2xkZXIpO1xuY29uc29sZS5sb2cobmV3THNTdXBlckZvbGRlcik7XG5cblxuLy8gR28gdGhyb3VnaCBhbGwgZm9sZGVycyBhbmQgY2hlY2sgaWYgdGhlIGNsaWNrZWQgYnV0dG9uIHZhbHVlIG1hdGNoZXMgZm9sZGVyIHZhbHVlXG4vLyB0aGVuIGRpc3BsYXkgdGFza3Mgb2YgdGhhdCBmb2xkZXIgdG8gc2NyZWVuXG5mdW5jdGlvbiBkaXNwbGF5Q3VycmVudEZvbGRlcldpdGhJZCh0ZW1wSWQpIHtcblxuICAgIHN1cGVyRm9sZGVyLmZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xuICAgICAgICBpZiAodGVtcElkID09PSBmb2xkZXIubXlGb2xkZXJVdWlkKSB7XG4gICAgICAgICAgICBjbGVhclRhc2tDb250YWluZXIoKTtcbiAgICAgICAgICAgIC8vZGlzcGxheSBhbGwgdGFza3Mgb2YgdGhpcyBmb2xkZXIgdG8gcGFnZVxuICAgICAgICAgICAgZGlzcGxheUZvbGRlclRhc2tzKGZvbGRlcik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1hdGNoIGZvdW5kXCIpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZUZvbGRlcldpdGhJZChidXR0b25JZCkge1xuICAgIHN1cGVyRm9sZGVyLmZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xuICAgICAgICBpZiAoYnV0dG9uSWQgPT09IGZvbGRlci5teUZvbGRlclV1aWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGJ1dHRvbklkKTtcbiAgICAgICAgICAgIHN1cGVyRm9sZGVyLmRlbGV0ZUZvbGRlcihmb2xkZXIpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZVRhc2tXaXRoSWQoYnV0dG9uSWQpIHtcbiAgICBzdXBlckZvbGRlci5mb2xkZXJzLmZvckVhY2goZm9sZGVyID0+IHtcbiAgICAgICAgZm9sZGVyLnRhc2tzLmZvckVhY2godGFzayA9PiB7XG4gICAgICAgICAgICBpZiAoYnV0dG9uSWQgPT09IHRhc2subXlUYXNrVXVpZCkge1xuICAgICAgICAgICAgICAgIGZvbGRlci5kZWxldGVUYXNrKHRhc2spO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBjaGFuZ2VUYXNrU3RhdHVzKHRhc2tJZCkge1xuICAgIHN1cGVyRm9sZGVyLmZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xuICAgICAgICBmb2xkZXIudGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgICAgIGlmICh0YXNrSWQgPT09IHRhc2subXlUYXNrVXVpZCkge1xuICAgICAgICAgICAgICAgIHRhc2suc2V0Q29tcGxldGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZmluZFRhc2tXaXRoSWQoYnV0dG9uSWQpIHtcbiAgICBsZXQgb3V0cHV0O1xuICAgIHN1cGVyRm9sZGVyLmZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xuICAgICAgICBmb2xkZXIudGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgICAgIGlmIChidXR0b25JZCA9PT0gdGFzay5teVRhc2tVdWlkKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gdGFzaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KTtcbiAgICByZXR1cm4gb3V0cHV0O1xufVxuXG5leHBvcnQge1xuICAgIGRpc3BsYXlDdXJyZW50Rm9sZGVyV2l0aElkLFxuICAgIGRlbGV0ZUZvbGRlcldpdGhJZCxcbiAgICBkZWxldGVUYXNrV2l0aElkLFxuICAgIGNoYW5nZVRhc2tTdGF0dXMsXG4gICAgZ2V0VGFza0RpYWxvZyxcbiAgICBmaW5kVGFza1dpdGhJZCxcbiAgICBnZXRFZGl0RGlhbG9nXG59Il0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwicmFuZG9tVVVJRCIsImNyeXB0byIsImJpbmQiLCJnZXRSYW5kb21WYWx1ZXMiLCJybmRzOCIsIlVpbnQ4QXJyYXkiLCJybmciLCJFcnJvciIsImJ5dGVUb0hleCIsImkiLCJwdXNoIiwidG9TdHJpbmciLCJzbGljZSIsIm9wdGlvbnMiLCJidWYiLCJvZmZzZXQiLCJybmRzIiwicmFuZG9tIiwiYXJyIiwidW5zYWZlU3RyaW5naWZ5IiwiVGFzayIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJkdWVEYXRlIiwicHJpb3JpdHkiLCJteVRhc2tVdWlkIiwiY29tcGxldGVTdGF0ZSIsImdldENvbXBsZXRlU3RhdGUiLCJjaGFuZ2VQcmlvcml0eSIsIm5ld1ByaW9yaXR5Iiwic2V0Q29tcGxldGUiLCJlZGl0VGFzayIsIm5ld1RpdGxlIiwibmV3RGVzY3JpcHRpb24iLCJuZXdEdWVEYXRlIiwicHJpbnRUYXNrIiwiY29uc29sZSIsImxvZyIsIkZvbGRlciIsIm15Rm9sZGVyVXVpZCIsInRhc2tzIiwiYWRkVGFzayIsIm5ld1Rhc2tOYW1lIiwiZGlzcGxheVRhc2tzIiwibGVuZ3RoIiwiZGVsZXRlVGFzayIsInRhc2tOYW1lIiwic3BsaWNlIiwiU3VwZXJGb2xkZXIiLCJteVN1cGVyRm9sZGVyVXVpZCIsImZvbGRlcnMiLCJhZGRGb2xkZXIiLCJuZXdGb2xkZXJOYW1lIiwiZGVsZXRlRm9sZGVyIiwiZm9sZGVyTmFtZSIsImxvY2FsU3RvcmFnZSIsInJlbW92ZUl0ZW0iLCJkaXNwbGF5Rm9sZGVyVGFza3MiLCJmb3JFYWNoIiwidGFzayIsImxvY2F0aW9uIiwidGFza0RPTSIsInRhc2tEaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ0YXNrVGl0bGVJbkRpdiIsInRhc2tEZXNjcmlwdGlvbkluRGl2IiwidGFza0R1ZURhdGVJbkRpdiIsInRhc2tQcmlvcml0eUluRGl2IiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJhcHBlbmRDaGlsZCIsInRhc2tEZWxldGVCdG4iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInRoaXNCdXR0b24iLCJ0YXJnZXQiLCJkZWxldGVUYXNrV2l0aElkIiwidmFsdWUiLCJwYXJlbnROb2RlIiwicmVtb3ZlIiwiY3JlYXRlVGFza0RlbGV0ZUJ1dHRvbiIsInRhc2tFZGl0QnRuIiwiZWRpdEZvcm0iLCJnZXRFbGVtZW50QnlJZCIsImJ0bkZvcklkIiwiZm9ybSIsInRhc2tUaXRsZUluRm9ybSIsImVsZW1lbnRzIiwidGFza0Rlc2NyaXB0aW9uSW5Gb3JtIiwidGFza0R1ZURhdGVJbkZvcm0iLCJ0YXNrUHJpb3JpdHlJbkZvcm0iLCJjaGFuZ2VUYXNrRm9ybUZpZWxkcyIsImZpbmRUYXNrV2l0aElkIiwiZ2V0RWRpdERpYWxvZyIsInNob3dNb2RhbCIsImNyZWF0ZVRhc2tFZGl0QnV0dG9uIiwidGFza1N0YXR1c0J0biIsImVsZW1lbnQiLCJjaGFuZ2VUYXNrU3RhdHVzIiwiY29udGFpbnMiLCJjcmVhdGVUYXNrU3RhdHVzQnV0dG9uIiwiY3JlYXRlVGFza0VsZW1lbnQiLCJhcHBlbmRUYXNrIiwiYXBwZW5kRm9sZGVyIiwiZm9sZGVyRE9NIiwic2lkZWJhciIsInF1ZXJ5U2VsZWN0b3IiLCJmb2xkZXJEaXYiLCJmb2xkZXJCdG4iLCJmb2xkZXIiLCJmb2xkZXJEZWxldGVCdG4iLCJkZWxldGVGb2xkZXJXaXRoSWQiLCJjcmVhdGVGb2xkZXJEZWxldGVCdXR0b24iLCJjdXJyZW50Rm9sZGVySWQiLCJkaXNwbGF5Q3VycmVudEZvbGRlcldpdGhJZCIsImNyZWF0ZUZvbGRlckJ1dHRvbiIsInN1cGVyRm9sZGVyIiwiZ2V0VGFza0RpYWxvZyIsInJlc2V0Iiwic2VsZWN0Iiwic2VsZWN0T3B0aW9uIiwiY2xlYXJTZWxlY3RNZW51Iiwib3B0aW9uIiwiYXBwZW5kRHJvcGRvd24iLCJwcmV2ZW50RGVmYXVsdCIsImZvbGRlckRpYWxvZyIsImZvbGRlclRpdGxlSW5Gb3JtIiwiZm9sZGVyRm9ybSIsImdldEZvbGRlckZvcm1JbmZvIiwibmV3Rm9sZGVyIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZWNyZWF0ZVN1cGVyRm9sZGVyRnJvbU9iamVjdCIsInBhcnNlIiwiZ2V0SXRlbSIsImNsb3NlIiwic2VsZWN0ZWRGb2xkZXJWYWx1ZSIsInRhc2tUaXRsZSIsInRhc2tEZXNjcmlwdGlvbiIsInRhc2tEdWVEYXRlIiwidGFza1ByaW9yaXR5IiwiZ2V0VGFza0Zvcm1JbmZvIiwibmV3VGFzayIsImJ0bklkIiwiZ2V0VGFza0VkaXRGb3JtSW5mbyIsInRhc2sxIiwidGFzazIiLCJ0YXNrMyIsImluYm94Rm9sZGVyIiwidGVzdEZvbGRlcjIiLCJnZW5lcmljT2JqIiwic3VwZXJGb2xkZXJEdXBlIiwiZm9sZGVyRHVwZSIsInRhcmdldE9iaiIsInJlY3JlYXRlVGFza09iaiIsInJlY3JlYXRlRm9sZGVyRnJvbU9iamVjdCIsInN1cGVyRm9sZGVyRnJvbUxzIiwibG9hZFByZXNldEZvbGRlcnMiLCJsc1N1cGVyRm9sZGVyIiwibmV3THNTdXBlckZvbGRlciIsInRlbXBJZCIsImJ1dHRvbklkIiwidGFza0lkIiwib3V0cHV0Il0sInNvdXJjZVJvb3QiOiIifQ==